{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/card.tsx"],"sourcesContent":["\nimport * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLHeadingElement, \n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3 \n    ref={ref}\n    className={cn(\n      \"text-xl font-normal uppercase tracking-wider leading-none\", \n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement, \n  React.HTMLAttributes<HTMLParagraphElement> \n>(({ className, ...props }, ref) => (\n  <p \n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;AACA;AAEA;;;;AAEA,MAAM,qBAAO,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,6DACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGrC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;AACA;AAEA;;;;AAEA,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB,0KACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SAAS;QACX;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAOF,SAAS,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAmB;IACzD,qBACE,8OAAC;QAAI,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QAAa,GAAG,KAAK;;;;;;AAExE","debugId":null}},
    {"offset": {"line": 130, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/products/ProductPricingClient.tsx"],"sourcesContent":["\n'use client';\n\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { useToast } from '@/hooks/use-toast';\nimport type { ProductPricingOption } from '@/types';\nimport { ShoppingCart, Tag, CalendarDays, DollarSign, CreditCard } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { useAuth } from '@/contexts/AuthContext';\nimport Link from 'next/link';\nimport { Card, CardContent, CardHeader, CardFooter, CardTitle, CardDescription } from '@/components/ui/card'; \n\ninterface ProductPricingClientProps {\n  productName: string;\n  productId: string; \n  allPricingOptions?: ProductPricingOption[];\n}\n\nconst ProductPricingClient: React.FC<ProductPricingClientProps> = ({\n  productName,\n  productId,\n  allPricingOptions = [],\n}) => {\n  const { toast } = useToast();\n  const { currentUser, fetchUserDetails } = useAuth();\n\n  const [uniqueModes, setUniqueModes] = useState<string[]>([]);\n  const [selectedMode, setSelectedMode] = useState<string | null>(null);\n  \n  const optionsForSelectedMode = useMemo(() => {\n    if (!selectedMode || !allPricingOptions) return [];\n    return allPricingOptions.filter(opt => {\n      const optModeLabel = opt.mode_label?.trim();\n      if (selectedMode === 'По умолчанию') {\n        return !optModeLabel; // Include options with null or empty mode_label\n      }\n      return optModeLabel === selectedMode;\n    });\n  }, [selectedMode, allPricingOptions]);\n\n  const [selectedOption, setSelectedOption] = useState<ProductPricingOption | null>(null);\n\n\n  useEffect(() => {\n    if (allPricingOptions && allPricingOptions.length > 0) {\n      const modes = new Set<string>();\n      let hasNullOrEmptyMode = false;\n      allPricingOptions.forEach(opt => {\n        if (opt.mode_label && opt.mode_label.trim() !== '') {\n          modes.add(opt.mode_label.trim());\n        } else {\n          hasNullOrEmptyMode = true;\n        }\n      });\n      \n      const distinctModes = Array.from(modes);\n      if (hasNullOrEmptyMode && distinctModes.length === 0) { \n        setUniqueModes(['По умолчанию']); \n        setSelectedMode('По умолчанию');\n      } else if (hasNullOrEmptyMode && distinctModes.length > 0) { \n        setUniqueModes([...distinctModes, 'По умолчанию']);\n        setSelectedMode(distinctModes[0]); \n      } else if (distinctModes.length > 0) { \n        setUniqueModes(distinctModes);\n        setSelectedMode(distinctModes[0]);\n      } else { \n        setUniqueModes([]);\n        setSelectedMode(null);\n      }\n    } else {\n      setUniqueModes([]);\n      setSelectedMode(null);\n    }\n  }, [allPricingOptions]);\n\n  useEffect(() => {\n    if (optionsForSelectedMode.length > 0) {\n      setSelectedOption(optionsForSelectedMode[0]);\n    } else {\n      setSelectedOption(null);\n    }\n  }, [optionsForSelectedMode]);\n\n\n  const handleModeSelect = (mode: string) => {\n    setSelectedMode(mode);\n  };\n\n  const handleDurationSelect = (option: ProductPricingOption) => {\n    setSelectedOption(option);\n  };\n\n  const handleBuyRub = () => {\n    // This will now be handled by your main payment gateway integration\n    toast({\n      title: \"Оплата RUB\",\n      description: \"Перенаправление на страницу оплаты...\",\n      variant: \"default\", \n    });\n    // Simulate redirect or call payment gateway API\n    // For example, router.push('/api/payment/initiate?productId=...&optionId=...')\n  };\n\n  const handleCustomPayment = (link: string | null | undefined) => {\n    if (link && link.trim() !== '' && link.trim() !== '#') {\n        window.open(link.trim(), '_blank');\n    } else {\n      toast({\n        title: \"Ссылка не настроена\",\n        description: \"Ссылка на оплату для этого способа не указана.\",\n        variant: \"default\", \n      });\n    }\n  };\n\n\n  const formatPrice = (price: number, currency: 'RUB' | 'GH') => {\n    const formattedNumber = Number.isInteger(price) \n      ? price.toLocaleString('ru-RU', { minimumFractionDigits: 0, maximumFractionDigits: 0 }) \n      : price.toLocaleString('ru-RU', { minimumFractionDigits: 2, maximumFractionDigits: 2 });\n    return `${formattedNumber} ${currency === 'RUB' ? '₽' : currency}`;\n  };\n\n\n  const handleBuyGh = async () => {\n    if (!currentUser) {\n      toast({ title: \"Ошибка\", description: \"Пожалуйста, войдите в аккаунт для покупки за GH.\", variant: \"destructive\" });\n      return;\n    }\n    if (!selectedOption) {\n      toast({ title: \"Ошибка\", description: \"Пожалуйста, выберите вариант.\", variant: \"destructive\" });\n      return;\n    }\n    if (currentUser.balance < selectedOption.price_gh) {\n      toast({ title: \"Недостаточно средств\", description: `На вашем балансе ${currentUser.balance.toFixed(2)} GH. Требуется ${selectedOption.price_gh.toFixed(2)} GH.`, variant: \"destructive\" });\n      return;\n    }\n\n    try {\n      const response = await fetch('/api/purchase/product', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ \n          userId: currentUser.id, \n          productId: productId, \n          productPricingOptionId: selectedOption.id, \n        }),\n      });\n\n      const data = await response.json();\n\n      if (!response.ok) {\n        throw new Error(data.message || \"Не удалось совершить покупку.\");\n      }\n      \n      if(currentUser.id) await fetchUserDetails(currentUser.id); \n\n      toast({\n        title: \"Покупка успешна!\",\n        description: `${productName} (${selectedOption.duration_days} дн.${selectedOption.mode_label && selectedOption.mode_label !== 'По умолчанию' ? `, ${selectedOption.mode_label}` : ''}) добавлен в ваш инвентарь.`,\n        action: (\n          <Button variant=\"link\" size=\"sm\" asChild className=\"text-primary\">\n            <Link href=\"/account/inventory\">Инвентарь</Link> \n          </Button>\n        ),\n      });\n    } catch (error: any) {\n      toast({ title: \"Ошибка покупки\", description: error.message, variant: \"destructive\" });\n    }\n  };\n\n  if (allPricingOptions.length === 0) {\n    return <p className=\"text-sm text-muted-foreground\">Варианты цен для этого товара еще не добавлены.</p>;\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {uniqueModes.length > 1 && (\n        <div>\n          <p className=\"text-sm font-medium text-foreground mb-2 flex items-center\"><Tag className=\"mr-2 h-4 w-4 text-primary/80\"/>Выберите режим:</p>\n          <div className=\"flex flex-wrap gap-2\">\n            {uniqueModes.map((mode) => (\n              <Button\n                key={mode}\n                variant={selectedMode === mode ? \"default\" : \"outline\"}\n                onClick={() => handleModeSelect(mode)}\n                className={cn(\n                  \"text-sm px-4 py-2 h-auto\", \n                  selectedMode === mode ? \"bg-primary text-primary-foreground\" : \"border-primary text-primary hover:bg-primary/10\"\n                )}\n                size=\"default\"\n              >\n                {mode}\n              </Button>\n            ))}\n          </div>\n        </div>\n      )}\n      {uniqueModes.length === 1 && selectedMode && selectedMode !== \"По умолчанию\" && (\n         <div>\n            <p className=\"text-sm font-medium text-foreground mb-0 flex items-center\"><Tag className=\"mr-2 h-4 w-4 text-primary/80\"/>Режим: <span className=\"ml-1 font-normal text-muted-foreground\">{selectedMode}</span></p>\n         </div>\n      )}\n\n      {optionsForSelectedMode.length > 0 && (\n        <div className=\"mt-3\">\n          <p className=\"text-sm font-medium text-foreground mb-2 flex items-center\"><CalendarDays className=\"mr-2 h-4 w-4 text-primary/80\"/>Выберите срок:</p>\n          <div className=\"grid grid-cols-2 sm:grid-cols-3 gap-2\">\n            {optionsForSelectedMode.map((option) => (\n              <Button\n                key={option.id}\n                variant={selectedOption?.id === option.id ? \"default\" : \"outline\"}\n                onClick={() => handleDurationSelect(option)}\n                className={cn(\n                  \"w-full justify-center text-center h-auto py-2 px-3 text-sm\", \n                  selectedOption?.id === option.id\n                    ? \"bg-primary text-primary-foreground border-primary\"\n                    : \"border-primary text-primary hover:bg-primary/10\"\n                )}\n              >\n                {option.duration_days} дн.\n              </Button>\n            ))}\n          </div>\n        </div>\n      )}\n       {optionsForSelectedMode.length === 0 && selectedMode && (\n        <p className=\"text-sm text-muted-foreground mt-2\">Варианты для режима \"{selectedMode}\" отсутствуют.</p>\n       )}\n\n      {selectedOption && (\n        <Card className=\"mt-4 bg-muted/20 border-border/30 shadow-inner\">\n            <CardHeader className=\"p-3\">\n                <CardTitle className=\"text-sm text-muted-foreground text-center\">\n                    {selectedOption.mode_label && selectedOption.mode_label !== 'По умолчанию' ? `Режим: ${selectedOption.mode_label}` : 'Стандартный режим'}\n                </CardTitle>\n                <CardDescription className=\"text-xs text-muted-foreground text-center\">\n                    Выбран срок: {selectedOption.duration_days} дн.\n                </CardDescription>\n            </CardHeader>\n            <CardContent className=\"p-3 pt-0 space-y-1\">\n                <div className=\"flex justify-between items-baseline text-primary font-bold\">\n                    <span className=\"text-sm text-muted-foreground flex items-center\"><CreditCard className=\"mr-1.5 h-4 w-4\"/>Стоимость:</span>\n                    <div className=\"text-right\">\n                        {selectedOption.price_rub > 0 && selectedOption.is_rub_payment_visible && <p className=\"text-lg\">{formatPrice(selectedOption.price_rub, 'RUB')}</p>}\n                        {selectedOption.price_gh > 0 && selectedOption.is_gh_payment_visible && <p className={cn(\"text-lg\", selectedOption.price_rub > 0 && selectedOption.is_rub_payment_visible && \"text-base\")}>{formatPrice(selectedOption.price_gh, 'GH')}</p>}\n                    </div>\n                </div>\n            </CardContent>\n            <CardFooter className=\"p-3 pt-2 flex flex-col gap-2\">\n                {selectedOption.price_rub > 0 && selectedOption.is_rub_payment_visible && (\n                <Button\n                    onClick={handleBuyRub}\n                    size=\"lg\"\n                    className=\"w-full bg-primary hover:bg-primary/90 text-primary-foreground shadow-md\"\n                >\n                    <ShoppingCart className=\"mr-2 h-5 w-5\" />\n                    Купить за {formatPrice(selectedOption.price_rub, 'RUB')}\n                </Button>\n                )}\n                {selectedOption.price_gh > 0 && selectedOption.is_gh_payment_visible && (\n                <Button onClick={handleBuyGh} size=\"lg\" variant=\"outline\" className=\"w-full border-primary text-primary hover:bg-primary/10 hover:text-primary/90 shadow-md\">\n                    <ShoppingCart className=\"mr-2 h-5 w-5\" />\n                    Купить за {formatPrice(selectedOption.price_gh, 'GH')}\n                </Button>\n                )}\n                {selectedOption.custom_payment_1_is_visible && selectedOption.custom_payment_1_label && selectedOption.custom_payment_1_price_rub !== null && (\n                    <Button onClick={() => handleCustomPayment(selectedOption.custom_payment_1_link)} size=\"lg\" variant=\"outline\" className=\"w-full border-secondary text-secondary-foreground hover:bg-secondary/10 shadow-md\">\n                        {selectedOption.custom_payment_1_label} за {formatPrice(selectedOption.custom_payment_1_price_rub, 'RUB')}\n                    </Button>\n                )}\n                {selectedOption.custom_payment_2_is_visible && selectedOption.custom_payment_2_label && selectedOption.custom_payment_2_price_rub !== null && (\n                     <Button onClick={() => handleCustomPayment(selectedOption.custom_payment_2_link)} size=\"lg\" variant=\"outline\" className=\"w-full border-secondary text-secondary-foreground hover:bg-secondary/10 shadow-md\">\n                        {selectedOption.custom_payment_2_label} за {formatPrice(selectedOption.custom_payment_2_price_rub, 'RUB')}\n                    </Button>\n                )}\n            </CardFooter>\n        </Card>\n      )}\n    </div>\n  );\n};\n\nexport default ProductPricingClient;\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 664, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/products/%5Bslug%5D/GalleryImageClient.tsx"],"sourcesContent":["'use client';\n\nimport Image from 'next/image';\nimport React, { useState } from 'react';\nimport { Dialog, DialogContent, DialogTrigger, DialogTitle } from '@/components/ui/dialog'; // Added DialogTitle\n\ninterface GalleryImageClientProps {\n  src: string;\n  alt: string;\n}\n\nconst GalleryImageClient: React.FC<GalleryImageClientProps> = ({ src, alt }) => {\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\n  return (\n    <Dialog open={isModalOpen} onOpenChange={setIsModalOpen}>\n      <DialogTrigger asChild>\n        <div className=\"relative aspect-video rounded-lg overflow-hidden border border-border cursor-pointer hover:opacity-80 transition-opacity\">\n          <Image \n            src={src} \n            alt={alt} \n            layout=\"fill\" \n            objectFit=\"cover\" \n            data-ai-hint=\"software menu screenshot\" \n          />\n        </div>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-3xl max-h-[80vh] p-2 bg-background border-border shadow-xl\">\n        {/* Visually hidden title for accessibility */}\n        <DialogTitle className=\"sr-only\">{`Enlarged image: ${alt}`}</DialogTitle>\n        <div className=\"relative w-full h-[75vh]\">\n            <Image src={src} alt={`${alt} - enlarged`} layout=\"fill\" objectFit=\"contain\" />\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n};\n\nexport default GalleryImageClient;\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA,mOAA4F,oBAAoB;AAJhH;;;;;AAWA,MAAM,qBAAwD,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE;IACzE,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAE/C,qBACE,8OAAC,kIAAA,CAAA,SAAM;QAAC,MAAM;QAAa,cAAc;;0BACvC,8OAAC,kIAAA,CAAA,gBAAa;gBAAC,OAAO;0BACpB,cAAA,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC,6HAAA,CAAA,UAAK;wBACJ,KAAK;wBACL,KAAK;wBACL,QAAO;wBACP,WAAU;wBACV,gBAAa;;;;;;;;;;;;;;;;0BAInB,8OAAC,kIAAA,CAAA,gBAAa;gBAAC,WAAU;;kCAEvB,8OAAC,kIAAA,CAAA,cAAW;wBAAC,WAAU;kCAAW,CAAC,gBAAgB,EAAE,KAAK;;;;;;kCAC1D,8OAAC;wBAAI,WAAU;kCACX,cAAA,8OAAC,6HAAA,CAAA,UAAK;4BAAC,KAAK;4BAAK,KAAK,GAAG,IAAI,WAAW,CAAC;4BAAE,QAAO;4BAAO,WAAU;;;;;;;;;;;;;;;;;;;;;;;AAK/E;uCAEe","debugId":null}},
    {"offset": {"line": 755, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ProductCard.tsx"],"sourcesContent":["\nimport Image from 'next/image';\nimport Link from 'next/link';\nimport type { Product } from '@/types';\nimport { Card, CardContent, CardTitle } from '@/components/ui/card'; \nimport { cn } from '@/lib/utils';\nimport { CheckCircle, RefreshCw, AlertTriangle, ShieldQuestion, ShoppingCart, ArrowRight } from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\n\n\ninterface ProductCardProps {\n  product: Product;\n  className?: string;\n}\n\nconst ProductCard = ({ product, className }: ProductCardProps) => {\n  const statusDetailsMap = {\n    safe: { text: 'Безопасен', icon: CheckCircle, glow: 'primary', iconColor: 'text-icon-color', badgeClass: 'bg-primary/20 text-primary border-primary/40' },\n    updating: { text: 'На обновлении', icon: RefreshCw, glow: 'sky', iconColor: 'text-sky-400', badgeClass: 'bg-sky-500/20 text-sky-400 border-sky-500/40 animate-pulse' },\n    risky: { text: 'Не безопасен', icon: AlertTriangle, glow: 'red', iconColor: 'text-red-400', badgeClass: 'bg-red-600/20 text-red-400 border-red-600/40' },\n    unknown: { text: 'На обновлении', icon: RefreshCw, glow: 'sky', iconColor: 'text-sky-400', badgeClass: 'bg-sky-500/20 text-sky-400 border-sky-500/40 animate-pulse' },\n  };\n\n  const currentStatus = statusDetailsMap[product.status] || statusDetailsMap.unknown;\n  const StatusIcon = currentStatus.icon;\n\n\n  const glowClasses = {\n    primary: 'hover:shadow-[0_0_15px_3px_hsl(var(--icon-color-hsl)/0.4)] border-icon-color', \n    orange: 'hover:shadow-[0_0_15px_3px_rgba(251,146,60,0.4)] border-orange-500/70', \n    red: 'hover:shadow-[0_0_15px_3px_rgba(239,68,68,0.4)] border-red-500/70',\n    sky: 'hover:shadow-[0_0_15px_3px_rgba(56,189,248,0.4)] border-sky-500/70', \n  };\n  const effectiveGlowClass = currentStatus.glow ? glowClasses[currentStatus.glow as keyof typeof glowClasses] : 'hover:border-icon-color/50';\n\n  const formatValue = (value: number | undefined | null): string => {\n    if (typeof value !== 'number' || value === null || isNaN(value)) {\n      return '';\n    }\n    if (value % 1 === 0) {\n      return value.toLocaleString('ru-RU', { minimumFractionDigits: 0, maximumFractionDigits: 0 });\n    }\n    return value.toLocaleString('ru-RU', { minimumFractionDigits: 0, maximumFractionDigits: 0 });\n  };\n\n  const formatPriceDisplay = (product: Product) => {\n    const hasRubPrice = product.min_price_rub !== undefined && product.min_price_rub !== null && product.min_price_rub >= 0;\n    const hasGhPrice = product.min_price_gh !== undefined && product.min_price_gh !== null && product.min_price_gh >= 0;\n\n    const rubPriceFormatted = hasRubPrice ? `${formatValue(product.min_price_rub!)} ₽` : '';\n    const ghPriceFormatted = hasGhPrice ? `${formatValue(product.min_price_gh!)} GH` : '';\n\n    if (hasRubPrice && hasGhPrice) {\n      return `от ${rubPriceFormatted} / ${ghPriceFormatted}`;\n    }\n    if (hasRubPrice) {\n      return `от ${rubPriceFormatted}`;\n    }\n    if (hasGhPrice) {\n      return `от ${ghPriceFormatted}`;\n    }\n    return product.price_text || 'Подробнее';\n  };\n\n  return (\n    <Card\n      className={cn(\n        \"overflow-hidden shadow-lg hover:shadow-primary/20 transition-all duration-300 ease-in-out transform hover:-translate-y-1 h-full flex flex-col border-2 border-card hover:border-icon-color/70 rounded-xl group\",\n        effectiveGlowClass,\n        className\n      )}\n    >\n      <Link href={`/products/${product.slug}`} className=\"block flex flex-col flex-grow\">\n        <div className=\"relative w-full h-52 md:h-56 overflow-hidden\">\n          <Image\n            src={product.imageUrl || product.image_url || 'https://placehold.co/400x300.png'}\n            alt={product.name}\n            layout=\"fill\"\n            objectFit=\"cover\"\n            className=\"transition-transform duration-500 ease-out group-hover:scale-110\"\n            data-ai-hint={product.data_ai_hint || `${product.name} game art`}\n          />\n           {product.gameLogoUrl && (\n            <div className=\"absolute top-3 right-3 bg-background/80 p-1.5 rounded-md shadow-md\">\n              <Image src={product.gameLogoUrl} alt={`${product.gameName || 'Game'} logo`} width={28} height={28} data-ai-hint=\"game logo icon\"/>\n            </div>\n          )}\n        </div>\n\n        <div className=\"p-4 flex flex-col flex-grow justify-between bg-card/50\">\n          <div>\n            <CardTitle className=\"text-lg md:text-xl font-semibold text-icon-color group-hover:text-primary transition-colors mb-1 truncate\" title={product.name}>\n              {product.name}\n            </CardTitle>\n            <Badge variant={currentStatus.badgeClass?.includes('primary') ? 'default' : currentStatus.badgeClass?.includes('orange') || currentStatus.badgeClass?.includes('sky') ? 'secondary' : currentStatus.badgeClass?.includes('red') ? 'destructive' : 'outline'} className={cn(\"text-xs py-0.5 px-2 mb-2\", currentStatus.badgeClass)}>\n                {StatusIcon && <StatusIcon className={cn(\"h-3 w-3 mr-1\", currentStatus.iconColor, product.status === 'updating' || product.status === 'unknown' ? 'animate-pulse' : '')} />}\n                {currentStatus.text}\n            </Badge>\n            {product.short_description && (\n              <CardContent className=\"text-xs md:text-sm text-muted-foreground mb-3 line-clamp-2 p-0\">\n                {product.short_description}\n              </CardContent>\n            )}\n          </div>\n          <div className=\"mt-auto flex items-center justify-between pt-2\">\n             <p className=\"text-base md:text-lg font-bold text-icon-color\">{formatPriceDisplay(product)}</p>\n            <Button variant=\"ghost\" size=\"sm\" className=\"text-icon-color hover:text-primary/80 hover:bg-transparent p-0 h-auto text-sm\">\n              Перейти <ArrowRight className=\"ml-1.5 h-4 w-4\" />\n            </Button>\n          </div>\n        </div>\n      </Link>\n    </Card>\n  );\n};\n\nexport default ProductCard;\n"],"names":[],"mappings":";;;;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;;;;;;;;;AAQA,MAAM,cAAc,CAAC,EAAE,OAAO,EAAE,SAAS,EAAoB;IAC3D,MAAM,mBAAmB;QACvB,MAAM;YAAE,MAAM;YAAa,MAAM,2NAAA,CAAA,cAAW;YAAE,MAAM;YAAW,WAAW;YAAmB,YAAY;QAA+C;QACxJ,UAAU;YAAE,MAAM;YAAiB,MAAM,gNAAA,CAAA,YAAS;YAAE,MAAM;YAAO,WAAW;YAAgB,YAAY;QAA6D;QACrK,OAAO;YAAE,MAAM;YAAgB,MAAM,wNAAA,CAAA,gBAAa;YAAE,MAAM;YAAO,WAAW;YAAgB,YAAY;QAA+C;QACvJ,SAAS;YAAE,MAAM;YAAiB,MAAM,gNAAA,CAAA,YAAS;YAAE,MAAM;YAAO,WAAW;YAAgB,YAAY;QAA6D;IACtK;IAEA,MAAM,gBAAgB,gBAAgB,CAAC,QAAQ,MAAM,CAAC,IAAI,iBAAiB,OAAO;IAClF,MAAM,aAAa,cAAc,IAAI;IAGrC,MAAM,cAAc;QAClB,SAAS;QACT,QAAQ;QACR,KAAK;QACL,KAAK;IACP;IACA,MAAM,qBAAqB,cAAc,IAAI,GAAG,WAAW,CAAC,cAAc,IAAI,CAA6B,GAAG;IAE9G,MAAM,cAAc,CAAC;QACnB,IAAI,OAAO,UAAU,YAAY,UAAU,QAAQ,MAAM,QAAQ;YAC/D,OAAO;QACT;QACA,IAAI,QAAQ,MAAM,GAAG;YACnB,OAAO,MAAM,cAAc,CAAC,SAAS;gBAAE,uBAAuB;gBAAG,uBAAuB;YAAE;QAC5F;QACA,OAAO,MAAM,cAAc,CAAC,SAAS;YAAE,uBAAuB;YAAG,uBAAuB;QAAE;IAC5F;IAEA,MAAM,qBAAqB,CAAC;QAC1B,MAAM,cAAc,QAAQ,aAAa,KAAK,aAAa,QAAQ,aAAa,KAAK,QAAQ,QAAQ,aAAa,IAAI;QACtH,MAAM,aAAa,QAAQ,YAAY,KAAK,aAAa,QAAQ,YAAY,KAAK,QAAQ,QAAQ,YAAY,IAAI;QAElH,MAAM,oBAAoB,cAAc,GAAG,YAAY,QAAQ,aAAa,EAAG,EAAE,CAAC,GAAG;QACrF,MAAM,mBAAmB,aAAa,GAAG,YAAY,QAAQ,YAAY,EAAG,GAAG,CAAC,GAAG;QAEnF,IAAI,eAAe,YAAY;YAC7B,OAAO,CAAC,GAAG,EAAE,kBAAkB,GAAG,EAAE,kBAAkB;QACxD;QACA,IAAI,aAAa;YACf,OAAO,CAAC,GAAG,EAAE,mBAAmB;QAClC;QACA,IAAI,YAAY;YACd,OAAO,CAAC,GAAG,EAAE,kBAAkB;QACjC;QACA,OAAO,QAAQ,UAAU,IAAI;IAC/B;IAEA,qBACE,8OAAC,gIAAA,CAAA,OAAI;QACH,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,kNACA,oBACA;kBAGF,cAAA,8OAAC,4JAAA,CAAA,UAAI;YAAC,MAAM,CAAC,UAAU,EAAE,QAAQ,IAAI,EAAE;YAAE,WAAU;;8BACjD,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,6HAAA,CAAA,UAAK;4BACJ,KAAK,QAAQ,QAAQ,IAAI,QAAQ,SAAS,IAAI;4BAC9C,KAAK,QAAQ,IAAI;4BACjB,QAAO;4BACP,WAAU;4BACV,WAAU;4BACV,gBAAc,QAAQ,YAAY,IAAI,GAAG,QAAQ,IAAI,CAAC,SAAS,CAAC;;;;;;wBAEhE,QAAQ,WAAW,kBACnB,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC,6HAAA,CAAA,UAAK;gCAAC,KAAK,QAAQ,WAAW;gCAAE,KAAK,GAAG,QAAQ,QAAQ,IAAI,OAAO,KAAK,CAAC;gCAAE,OAAO;gCAAI,QAAQ;gCAAI,gBAAa;;;;;;;;;;;;;;;;;8BAKtH,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;;8CACC,8OAAC,gIAAA,CAAA,YAAS;oCAAC,WAAU;oCAA4G,OAAO,QAAQ,IAAI;8CACjJ,QAAQ,IAAI;;;;;;8CAEf,8OAAC,iIAAA,CAAA,QAAK;oCAAC,SAAS,cAAc,UAAU,EAAE,SAAS,aAAa,YAAY,cAAc,UAAU,EAAE,SAAS,aAAa,cAAc,UAAU,EAAE,SAAS,SAAS,cAAc,cAAc,UAAU,EAAE,SAAS,SAAS,gBAAgB;oCAAW,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,4BAA4B,cAAc,UAAU;;wCAC1T,4BAAc,8OAAC;4CAAW,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,gBAAgB,cAAc,SAAS,EAAE,QAAQ,MAAM,KAAK,cAAc,QAAQ,MAAM,KAAK,YAAY,kBAAkB;;;;;;wCACnK,cAAc,IAAI;;;;;;;gCAEtB,QAAQ,iBAAiB,kBACxB,8OAAC,gIAAA,CAAA,cAAW;oCAAC,WAAU;8CACpB,QAAQ,iBAAiB;;;;;;;;;;;;sCAIhC,8OAAC;4BAAI,WAAU;;8CACZ,8OAAC;oCAAE,WAAU;8CAAkD,mBAAmB;;;;;;8CACnF,8OAAC,kIAAA,CAAA,SAAM;oCAAC,SAAQ;oCAAQ,MAAK;oCAAK,WAAU;;wCAAgF;sDAClH,8OAAC,kNAAA,CAAA,aAAU;4CAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAO5C;uCAEe","debugId":null}},
    {"offset": {"line": 1000, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport {cn} from '@/lib/utils';\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, React.ComponentProps<'textarea'>>(\n  ({className, ...props}, ref) => {\n    return (\n      <textarea\n        className={cn(\n          'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\nTextarea.displayName = 'Textarea';\n\nexport {Textarea};\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAEA,MAAM,yBAAW,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC9B,CAAC,EAAC,SAAS,EAAE,GAAG,OAAM,EAAE;IACtB,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,qTACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,SAAS,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 1028, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/products/ProductReviewForm.tsx"],"sourcesContent":["\n'use client';\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport * as z from 'zod';\nimport { Button } from '@/components/ui/button';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { useToast } from '@/hooks/use-toast';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { Star, Send, MessageSquare, Loader2, ShoppingCart, AlertCircle } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport Link from 'next/link';\n\nconst reviewFormSchema = z.object({\n  rating: z.coerce.number().min(1, \"Пожалуйста, выберите рейтинг.\").max(5),\n  text: z.string().min(10, \"Отзыв должен содержать не менее 10 символов.\").max(2000, \"Отзыв не должен превышать 2000 символов.\"),\n});\n\ntype ReviewFormValues = z.infer<typeof reviewFormSchema>;\n\ninterface ProductReviewFormProps {\n  productId: string; // slug\n  productName: string;\n  onReviewSubmitted?: () => void;\n}\n\nconst ProductReviewForm: React.FC<ProductReviewFormProps> = ({ productId, productName, onReviewSubmitted }) => {\n  const { toast } = useToast();\n  const { currentUser } = useAuth();\n  const [isLoading, setIsLoading] = useState(false);\n  const [hoverRating, setHoverRating] = useState(0);\n  const [hasPurchasedProduct, setHasPurchasedProduct] = useState(false);\n  const [isCheckingPurchase, setIsCheckingPurchase] = useState(true);\n\n  const form = useForm<ReviewFormValues>({\n    resolver: zodResolver(reviewFormSchema),\n    defaultValues: {\n      rating: 0,\n      text: '',\n    },\n  });\n  const selectedRating = form.watch(\"rating\");\n\n  const checkPurchase = useCallback(async () => {\n    if (!currentUser || !productId) {\n      setIsCheckingPurchase(false);\n      setHasPurchasedProduct(false);\n      return;\n    }\n    setIsCheckingPurchase(true);\n    try {\n      const response = await fetch(`/api/user/${currentUser.id}/has-purchased/${productId}`);\n      if (response.ok) {\n        const data = await response.json();\n        setHasPurchasedProduct(data.hasPurchased);\n      } else {\n        setHasPurchasedProduct(false);\n      }\n    } catch (error) {\n      console.error(\"Error checking purchase status:\", error);\n      setHasPurchasedProduct(false);\n    } finally {\n      setIsCheckingPurchase(false);\n    }\n  }, [currentUser, productId]);\n\n  useEffect(() => {\n    checkPurchase();\n  }, [checkPurchase]);\n\n  const onSubmit = async (data: ReviewFormValues) => {\n    if (!currentUser) {\n      toast({ title: \"Ошибка\", description: \"Для оставления отзыва необходимо авторизоваться.\", variant: \"destructive\" });\n      return;\n    }\n    if (!hasPurchasedProduct) {\n      toast({ title: \"Действие не разрешено\", description: `Чтобы оставить отзыв, вам необходимо приобрести подписку на \"${productName}\".`, variant: \"destructive\" });\n      return;\n    }\n    setIsLoading(true);\n    try {\n      const response = await fetch(`/api/products/${productId}/reviews`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          userId: currentUser.id,\n          rating: data.rating,\n          text: data.text,\n        }),\n      });\n      const result = await response.json();\n      if (!response.ok) {\n        throw new Error(result.message || 'Не удалось отправить отзыв.');\n      }\n      toast({\n        title: \"Отзыв отправлен!\",\n        description: \"Спасибо! Ваш отзыв отправлен на модерацию.\",\n      });\n      form.reset();\n      if (onReviewSubmitted) {\n        onReviewSubmitted();\n      }\n    } catch (error: any) {\n      toast({\n        title: \"Ошибка\",\n        description: error.message || \"Произошла ошибка при отправке отзыва.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (!currentUser) {\n    return (\n        <Card className=\"mt-8 shadow-md border-border/30 bg-card\">\n            <CardHeader>\n                <CardTitle className=\"text-lg text-primary flex items-center\"><MessageSquare className=\"mr-2 h-5 w-5\"/> Оставить отзыв</CardTitle>\n            </CardHeader>\n            <CardContent>\n                <p className=\"text-muted-foreground\">\n                    Пожалуйста, <Link href=\"/auth/login\" className=\"text-primary hover:underline\">войдите</Link> или <Link href=\"/auth/register\" className=\"text-primary hover:underline\">зарегистрируйтесь</Link>, чтобы оставить отзыв.\n                </p>\n            </CardContent>\n        </Card>\n    );\n  }\n\n  if (isCheckingPurchase) {\n    return (\n        <Card className=\"mt-8 shadow-md border-border/30 bg-card\">\n            <CardHeader>\n                <CardTitle className=\"text-lg text-primary flex items-center\"><MessageSquare className=\"mr-2 h-5 w-5\"/> Оставить отзыв</CardTitle>\n            </CardHeader>\n            <CardContent className=\"py-10 flex items-center justify-center\">\n                <Loader2 className=\"h-6 w-6 animate-spin text-primary mr-2\" />\n                <p className=\"text-muted-foreground\">Проверка ваших покупок...</p>\n            </CardContent>\n        </Card>\n    );\n  }\n\n  if (!hasPurchasedProduct) {\n    return (\n        <Card className=\"mt-8 shadow-md border-border/30 bg-card\">\n            <CardHeader>\n                <CardTitle className=\"text-lg text-primary flex items-center\"><AlertCircle className=\"mr-2 h-5 w-5\"/> Оставить отзыв</CardTitle>\n            </CardHeader>\n            <CardContent>\n                <p className=\"text-muted-foreground\">\n                    Чтобы оставить отзыв, вам необходимо приобрести подписку на \"{productName}\".\n                </p>\n                <Button asChild className=\"mt-3 bg-primary hover:bg-primary/90 text-primary-foreground\">\n                    <Link href={`/products/${productId}`}>\n                        <ShoppingCart className=\"mr-2 h-4 w-4\"/> К покупке\n                    </Link>\n                </Button>\n            </CardContent>\n        </Card>\n    );\n  }\n\n\n  return (\n    <Card className=\"mt-8 shadow-md border-border/30 bg-card\">\n      <CardHeader>\n        <CardTitle className=\"text-lg text-primary flex items-center\"><MessageSquare className=\"mr-2 h-5 w-5\"/> Оставить отзыв о \"{productName}\"</CardTitle>\n      </CardHeader>\n      <CardContent>\n        <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n          <div>\n            <Label className=\"text-foreground mb-2 block\">Ваша оценка:</Label>\n            <div className=\"flex items-center space-x-1\" onMouseLeave={() => setHoverRating(0)}>\n              {[1, 2, 3, 4, 5].map((star) => (\n                <Star\n                  key={star}\n                  className={cn(\n                    \"h-7 w-7 cursor-pointer transition-colors\",\n                    (hoverRating >= star || selectedRating >= star)\n                      ? \"text-yellow-400 fill-yellow-400\"\n                      : \"text-muted-foreground hover:text-yellow-300\"\n                  )}\n                  onClick={() => form.setValue(\"rating\", star, { shouldValidate: true })}\n                  onMouseEnter={() => setHoverRating(star)}\n                />\n              ))}\n            </div>\n            {form.formState.errors.rating && <p className=\"text-sm text-destructive mt-1\">{form.formState.errors.rating.message}</p>}\n          </div>\n          <div>\n            <Label htmlFor=\"reviewText\" className=\"text-foreground\">Ваш отзыв:</Label>\n            <Textarea\n              id=\"reviewText\"\n              {...form.register(\"text\")}\n              placeholder={`Поделитесь своим мнением о ${productName}...`}\n              className=\"mt-1 min-h-[100px] bg-background\"\n              disabled={isLoading}\n            />\n            {form.formState.errors.text && <p className=\"text-sm text-destructive mt-1\">{form.formState.errors.text.message}</p>}\n          </div>\n          <Button type=\"submit\" className=\"bg-primary hover:bg-primary/90 text-primary-foreground\" disabled={isLoading}>\n            {isLoading ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Send className=\"mr-2 h-4 w-4\"/>}\n            Отправить отзыв\n          </Button>\n        </form>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default ProductReviewForm;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1541, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/products/ProductReviewsDisplay.tsx"],"sourcesContent":["\n'use client';\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\nimport { MessageSquareText, Loader2, AlertTriangle, Star, UserCircle, ChevronRight } from 'lucide-react';\nimport type { Review } from '@/types';\nimport { useToast } from '@/hooks/use-toast';\nimport Image from 'next/image';\nimport { cn } from '@/lib/utils';\nimport Link from 'next/link';\n\ninterface ProductReviewsDisplayProps {\n  productId: string; // slug\n  productName: string;\n  refreshTrigger?: number; // Optional prop to trigger re-fetch\n}\n\nconst ReviewCard: React.FC<{ review: Review }> = ({ review }) => {\n  const formatDate = (dateString: string | undefined | null) => {\n    if (!dateString) return 'N/A';\n    return new Date(dateString).toLocaleDateString('ru-RU', { year: 'numeric', month: 'long', day: 'numeric' });\n  };\n\n  const StarRating = ({ rating }: { rating: number }) => (\n    <div className=\"flex\">\n      {[1, 2, 3, 4, 5].map((star) => (\n        <Star key={star} className={cn(\"h-4 w-4\", rating >= star ? \"text-yellow-400 fill-yellow-400\" : \"text-muted-foreground/50\")} />\n      ))}\n    </div>\n  );\n\n  return (\n    <div className=\"p-4 border border-border/30 rounded-lg bg-muted/20 shadow-sm\">\n      <div className=\"flex items-start gap-3\">\n        <Image \n          src={review.user_avatar_url || `https://placehold.co/40x40.png?text=${review.username ? review.username[0].toUpperCase() : 'U'}`} \n          alt={review.username} \n          width={36} \n          height={36} \n          className=\"rounded-full\" \n          data-ai-hint=\"user avatar\"\n        />\n        <div className=\"flex-1\">\n          <div className=\"flex items-center justify-between\">\n            <p className=\"font-semibold text-sm text-foreground\">{review.username}</p>\n            <StarRating rating={review.rating} />\n          </div>\n          <p className=\"text-xs text-muted-foreground\">{formatDate(review.approved_at || review.created_at)}</p>\n        </div>\n      </div>\n      <p className=\"text-sm text-foreground/80 mt-2 whitespace-pre-wrap\">{review.text}</p>\n       {review.duration_days && (\n        <p className=\"text-xs text-muted-foreground mt-1\">\n          (Относится к варианту: {review.duration_days} дн.)\n        </p>\n      )}\n    </div>\n  );\n};\n\n\nconst ProductReviewsDisplay: React.FC<ProductReviewsDisplayProps> = ({ productId, productName, refreshTrigger }) => {\n  const [reviews, setReviews] = useState<Review[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const { toast } = useToast();\n\n  const fetchReviews = useCallback(async () => {\n    if (!productId) return;\n    setIsLoading(true);\n    setError(null);\n    try {\n      const response = await fetch(`/api/products/${productId}/reviews`);\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({ message: 'Failed to fetch reviews for this product' }));\n        throw new Error(errorData.message);\n      }\n      const data: Review[] = await response.json();\n      setReviews(data);\n    } catch (err: any) {\n      setError(err.message || `Не удалось загрузить отзывы для ${productName}.`);\n      // toast({ title: \"Ошибка загрузки отзывов\", description: err.message, variant: \"destructive\" });\n    } finally {\n      setIsLoading(false);\n    }\n  }, [productId, productName, toast]);\n\n  useEffect(() => {\n    fetchReviews();\n  }, [fetchReviews, refreshTrigger]); // Re-fetch when refreshTrigger changes\n\n  return (\n    <Card className=\"mt-8 shadow-md border-border/30 bg-card\">\n      <CardHeader>\n        <CardTitle className=\"text-lg text-primary flex items-center\"><MessageSquareText className=\"mr-2 h-5 w-5\"/> Отзывы о \"{productName}\"</CardTitle>\n        {reviews.length > 0 && <CardDescription className=\"text-muted-foreground\">Что говорят другие игроки.</CardDescription>}\n      </CardHeader>\n      <CardContent>\n        {isLoading ? (\n          <div className=\"flex justify-center items-center py-6\">\n            <Loader2 className=\"h-6 w-6 animate-spin text-primary\" />\n            <p className=\"ml-2 text-muted-foreground\">Загрузка отзывов...</p>\n          </div>\n        ) : error ? (\n          <div className=\"text-center py-6 text-destructive\">\n            <AlertTriangle className=\"mx-auto h-8 w-8 mb-2\" />\n            <p>{error}</p>\n          </div>\n        ) : reviews.length > 0 ? (\n          <div className=\"space-y-4\">\n            {reviews.map((review) => (\n              <ReviewCard key={review.id} review={review} />\n            ))}\n             {reviews.length >= 3 && ( // Show link if there are enough reviews to warrant a separate page\n                <div className=\"text-center mt-4\">\n                    <Button variant=\"link\" asChild className=\"text-primary hover:text-primary/80\">\n                        <Link href=\"/reviews\">\n                            Все отзывы <ChevronRight className=\"h-4 w-4 ml-1\"/>\n                        </Link>\n                    </Button>\n                </div>\n            )}\n          </div>\n        ) : (\n          <p className=\"text-muted-foreground text-center py-6\">Отзывов для этого товара пока нет. Будьте первым!</p>\n        )}\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default ProductReviewsDisplay;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1881, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/products/%5Bslug%5D/ProductClientContent.tsx"],"sourcesContent":["\n'use client'; \n\nimport React, { useState } from 'react'; \nimport { useAuth } from '@/contexts/AuthContext';\nimport Image from 'next/image';\nimport Link from 'next/link';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { CheckCircle, RefreshCw, AlertTriangle, ShieldQuestion, ArrowLeft, Edit, Cog, Info, Palette, VenetianMask, Eye, Sparkles, Ticket, MessageSquare } from 'lucide-react'; \nimport { cn } from '@/lib/utils';\nimport ProductPricingClient from '@/components/products/ProductPricingClient';\nimport GalleryImageClient from './GalleryImageClient';\nimport ProductCard from '@/components/ProductCard'; \nimport type { Product, Category } from '@/types';\nimport ProductReviewForm from '@/components/products/ProductReviewForm'; \nimport ProductReviewsDisplay from '@/components/products/ProductReviewsDisplay'; \n\nconst statusDetailsMap = {\n  safe: { text: 'Безопасен', icon: CheckCircle, colorClass: 'text-primary', badgeClass: 'bg-primary/20 text-primary border-primary/40' },\n  updating: { text: 'На обновлении', icon: RefreshCw, colorClass: 'text-sky-400', badgeClass: 'bg-sky-500/20 text-sky-400 border-sky-500/40 animate-pulse' },\n  risky: { text: 'Не безопасен', icon: AlertTriangle, colorClass: 'text-red-400', badgeClass: 'bg-red-600/20 text-red-400 border-red-600/40' },\n  unknown: { text: 'На обновлении', icon: RefreshCw, colorClass: 'text-sky-400', badgeClass: 'bg-sky-500/20 text-sky-400 border-sky-500/40 animate-pulse' },\n};\n\nconst isValidImageUrl = (url: string | undefined | null): url is string => {\n  if (!url || typeof url !== 'string' || url.trim() === '') {\n    return false;\n  }\n  try {\n    new URL(url.trim());\n    return /\\.(jpeg|jpg|gif|png|webp)$/i.test(new URL(url.trim()).pathname);\n  } catch (e) {\n    return false;\n  }\n};\n\ninterface ProductClientContentProps {\n  product: Product;\n  category: Category | undefined;\n  relatedProducts: Product[];\n}\n\nconst ProductClientContent: React.FC<ProductClientContentProps> = ({ product, category, relatedProducts }) => {\n  const { currentUser } = useAuth();\n  const [reviewRefreshTrigger, setReviewRefreshTrigger] = useState(0); \n\n  const currentStatus = statusDetailsMap[product.status] || statusDetailsMap.unknown;\n  const StatusIcon = currentStatus.icon;\n\n  const validGalleryImageUrls = (product.gallery_image_urls?.map(url => url.trim()).filter(isValidImageUrl) || []);\n  \n  const handleReviewSubmitted = () => {\n    setReviewRefreshTrigger(prev => prev + 1); \n  };\n\n  const FunctionSection: React.FC<{title?: string | null, description?: string | null, functions?: string[] | null, icon?: React.ElementType}> = \n    ({ title, description, functions, icon: IconComponent }) => {\n    if (!title || !functions || functions.length === 0) return null;\n    return (\n      <div className=\"p-4 border border-border/30 rounded-md bg-card/50 shadow-sm\">\n        <h4 className=\"text-md font-semibold text-primary mb-1.5 flex items-center\">\n          {IconComponent && <IconComponent className=\"mr-2 h-5 w-5 text-primary/80\"/>}\n          {title}\n        </h4>\n        {description && <p className=\"text-xs text-muted-foreground mb-2\">{description}</p>}\n        <div className=\"flex flex-wrap gap-2\">\n          {functions.map((func, idx) => (\n            <Badge key={`${title}-${idx}`} variant=\"outline\" className=\"border-primary/50 text-foreground/90 text-xs\">\n              {func}\n            </Badge>\n          ))}\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"container mx-auto px-4 py-8\">\n      <div className=\"flex items-center gap-2 mb-6\">\n        <Button asChild variant=\"outline\" className=\"border-primary text-primary hover:bg-primary/10\">\n          <Link href={category ? `/games/${category.slug}` : \"/games\"}>\n            <ArrowLeft className=\"mr-2 h-4 w-4\" />\n            Назад к {category ? category.name : 'Каталогу'}\n          </Link>\n        </Button>\n        {currentUser?.role === 'admin' && (\n          <Button asChild variant=\"outline\" className=\"border-icon-color text-icon-color hover:bg-icon-color/10 hover:text-icon-color/90\">\n            <Link href={`/admin/products/${product.slug}/edit`}>\n              <Edit className=\"mr-2 h-4 w-4\" />\n              Редактировать товар\n            </Link>\n          </Button>\n        )}\n      </div>\n\n      <div className=\"grid lg:grid-cols-3 gap-8\">\n        <div className=\"lg:col-span-2 space-y-8\">\n          <Card className=\"shadow-xl overflow-hidden\">\n            <CardHeader className=\"p-6 border-b border-border\">\n              <div className=\"flex flex-col sm:flex-row sm:items-start sm:justify-between\">\n                <div>\n                  <h1 className=\"text-2xl md:text-3xl font-semibold text-foreground mb-1\">{product.name}</h1>\n                  {category && (\n                    <Link href={`/games/${category.slug}`} className=\"text-sm text-muted-foreground hover:text-primary transition-colors block mb-2 sm:mb-0\">\n                      Категория: {category.name}\n                    </Link>\n                  )}\n                </div>\n                 <div className=\"flex items-center gap-2 mt-2 sm:mt-0\">\n                    {StatusIcon && <StatusIcon className={cn(\"h-4 w-4 sm:h-5 sm:w-5\", currentStatus.iconColor, product.status === 'updating' || product.status === 'unknown' ? 'animate-pulse' : '')} />}\n                    <span className={cn(\"text-xs sm:text-sm font-medium\", currentStatus.colorClass)}>\n                      {product.status_text || currentStatus.text}\n                    </span>\n                </div>\n              </div>\n            </CardHeader>\n\n            {validGalleryImageUrls && validGalleryImageUrls.length > 0 && (\n              <CardContent className=\"p-6\">\n                <h3 className=\"text-xl font-bold text-foreground mb-3 uppercase\">Галерея (Меню софта)</h3>\n                <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\n                  {validGalleryImageUrls.map((url, index) => (\n                     <GalleryImageClient key={index} src={url} alt={`${product.name} - Gallery image ${index + 1}`} />\n                  ))}\n                </div>\n              </CardContent>\n            )}\n            \n            <CardContent className=\"p-6 border-t border-border\">\n              <h3 className=\"text-xl font-bold text-foreground mb-3 uppercase\">Описание</h3>\n              {product.long_description ? (\n                <div className=\"prose prose-sm dark:prose-invert max-w-none text-foreground/80\" dangerouslySetInnerHTML={{ __html: product.long_description }} />\n              ) : product.short_description ? (\n                <p className=\"text-foreground/80\">{product.short_description}</p>\n              ) : (\n                <p className=\"text-muted-foreground\">Описание для этого товара еще не добавлено.</p>\n              )}\n            </CardContent>\n\n\n            { (product.functions_aim_title && product.functions_aim && product.functions_aim.length > 0) || \n              (product.functions_esp_title && product.functions_wallhack && product.functions_wallhack.length > 0) || \n              (product.functions_misc_title && product.functions_misc && product.functions_misc.length > 0) ? (\n              <CardContent className=\"p-6 border-t border-border\">\n                <h3 className=\"text-xl font-bold text-foreground mb-4 uppercase\">Функционал</h3>\n                 <div className=\"space-y-4\">\n                    <FunctionSection \n                        title={product.functions_aim_title} \n                        description={product.functions_aim_description}\n                        functions={product.functions_aim}\n                        icon={VenetianMask} \n                    />\n                    <FunctionSection \n                        title={product.functions_esp_title} \n                        description={product.functions_esp_description}\n                        functions={product.functions_wallhack}\n                        icon={Eye} \n                    />\n                    <FunctionSection \n                        title={product.functions_misc_title} \n                        description={product.functions_misc_description}\n                        functions={product.functions_misc}\n                        icon={Sparkles} \n                    />\n                 </div>\n              </CardContent>\n            ) : null }\n          </Card>\n\n          <ProductReviewsDisplay \n            productId={product.slug} \n            productName={product.name} \n            refreshTrigger={reviewRefreshTrigger}\n          />\n\n          <ProductReviewForm \n            productId={product.slug} \n            productName={product.name} \n            onReviewSubmitted={handleReviewSubmitted}\n          />\n\n\n          <div className=\"mt-8\">\n             <h3 className=\"text-xl text-foreground font-bold uppercase mb-4\">Похожие товары</h3>\n             {relatedProducts.length > 0 ? (\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6\">\n                    {relatedProducts.map((relatedProd) => (\n                        <ProductCard key={relatedProd.id} product={relatedProd} />\n                    ))}\n                </div>\n            ) : (\n                <p className=\"text-muted-foreground\">Других товаров в этой категории пока нет.</p>\n            )}\n          </div>\n        </div>\n\n        <div className=\"lg:col-span-1\">\n          <div className=\"lg:sticky lg:top-24 space-y-8\">\n            <Card className=\"shadow-lg\">\n              <CardHeader>\n                <CardTitle className=\"text-xl text-primary flex items-center font-bold uppercase\"><Ticket className=\"mr-2 h-6 w-6\"/>Стоимость</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <ProductPricingClient\n                  productName={product.name}\n                  productId={product.id} \n                  allPricingOptions={product.pricing_options || []}\n                />\n              </CardContent>\n            </Card>\n\n            <Card className=\"shadow-lg\">\n              <CardHeader>\n                  <CardTitle className=\"text-xl text-primary flex items-center font-bold uppercase\"><Info className=\"mr-2 h-6 w-6\"/>Важно</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-2 text-sm text-foreground/80\">\n                {product.system_os && <p><strong className=\"text-foreground/90\">Система:</strong> {product.system_os}</p>}\n                {product.system_build && <p><strong className=\"text-foreground/90\">Сборка:</strong> {product.system_build}</p>}\n                {product.system_gpu && <p><strong className=\"text-foreground/90\">Видеокарта:</strong> {product.system_gpu}</p>}\n                {product.system_cpu && <p><strong className=\"text-foreground/90\">Процессор:</strong> {product.system_cpu}</p>}\n                {!product.system_os && !product.system_build && !product.system_gpu && !product.system_cpu && (\n                  <p className=\"text-muted-foreground\">Требования к системе не указаны.</p>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ProductClientContent;\n"],"names":[],"mappings":"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","debugId":null}}]
}