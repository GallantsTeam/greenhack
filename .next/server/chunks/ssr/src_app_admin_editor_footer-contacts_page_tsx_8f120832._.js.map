{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/admin/editor/footer-contacts/page.tsx"],"sourcesContent":["\n'use client';\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport * as z from 'zod';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Button } from '@/components/ui/button';\nimport { Loader2, MessageCircle, Users, Bot, Mail } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport type { SiteSettings } from '@/types';\nimport { Separator } from '@/components/ui/separator';\n\nconst footerContactsSchema = z.object({\n  contact_vk_label: z.string().max(255).optional().nullable(),\n  contact_vk_url: z.string().url({ message: \"Неверный URL для VK.\" }).optional().or(z.literal('')).nullable(),\n  contact_telegram_bot_label: z.string().max(255).optional().nullable(),\n  contact_telegram_bot_url: z.string().url({ message: \"Неверный URL для Telegram.\" }).optional().or(z.literal('')).nullable(),\n  contact_email_label: z.string().max(255).optional().nullable(),\n  contact_email_address: z.string().email({ message: \"Неверный формат Email.\" }).optional().or(z.literal('')).nullable(),\n});\n\ntype FooterContactsFormValues = z.infer<typeof footerContactsSchema>;\n\nexport default function AdminFooterContactsPage() {\n  const { toast } = useToast();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isFetching, setIsFetching] = useState(true);\n\n  const form = useForm<FooterContactsFormValues>({\n    resolver: zodResolver(footerContactsSchema),\n    defaultValues: {\n      contact_vk_label: '',\n      contact_vk_url: '',\n      contact_telegram_bot_label: '',\n      contact_telegram_bot_url: '',\n      contact_email_label: '',\n      contact_email_address: '',\n    },\n  });\n\n  const fetchFooterSettings = useCallback(async () => {\n    setIsFetching(true);\n    try {\n      const response = await fetch('/api/admin/site-settings'); // Use the main site settings endpoint\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({ message: 'Не удалось загрузить настройки футера.' }));\n        throw new Error(errorData.message);\n      }\n      const data: SiteSettings = await response.json();\n      form.reset({\n        contact_vk_label: data.contact_vk_label || 'Наша беседа VK',\n        contact_vk_url: data.contact_vk_url || '',\n        contact_telegram_bot_label: data.contact_telegram_bot_label || 'Наш Telegram Бот',\n        contact_telegram_bot_url: data.contact_telegram_bot_url || '',\n        contact_email_label: data.contact_email_label || 'Email поддержки',\n        contact_email_address: data.contact_email_address || '',\n      });\n    } catch (error: any) {\n      toast({ title: \"Ошибка загрузки\", description: error.message, variant: \"destructive\" });\n    } finally {\n      setIsFetching(false);\n    }\n  }, [form, toast]);\n\n  useEffect(() => {\n    fetchFooterSettings();\n  }, [fetchFooterSettings]);\n\n  const onSubmit = async (data: FooterContactsFormValues) => {\n    setIsLoading(true);\n    try {\n      // Fetch existing site settings to merge with footer contacts\n      const existingSettingsRes = await fetch('/api/admin/site-settings');\n      if (!existingSettingsRes.ok) throw new Error('Could not fetch existing settings to merge.');\n      const existingSettings: SiteSettings = await existingSettingsRes.json();\n\n      const payload = { ...existingSettings, ...data };\n\n      const response = await fetch('/api/admin/site-settings', {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload),\n      });\n      const result = await response.json();\n      if (!response.ok) throw new Error(result.message || 'Не удалось сохранить настройки футера.');\n      toast({ title: \"Настройки сохранены\", description: \"Контакты в футере успешно обновлены.\" });\n      if(result.settings) {\n        form.reset({ // Re-set form with potentially updated values\n            contact_vk_label: result.settings.contact_vk_label || '',\n            contact_vk_url: result.settings.contact_vk_url || '',\n            contact_telegram_bot_label: result.settings.contact_telegram_bot_label || '',\n            contact_telegram_bot_url: result.settings.contact_telegram_bot_url || '',\n            contact_email_label: result.settings.contact_email_label || '',\n            contact_email_address: result.settings.contact_email_address || '',\n        });\n      }\n    } catch (error: any) {\n      toast({ title: \"Ошибка сохранения\", description: error.message, variant: \"destructive\" });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (isFetching) {\n    return (\n        <div className=\"flex items-center justify-center p-10\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n            <p className=\"ml-3 text-muted-foreground\">Загрузка настроек контактов...</p>\n        </div>\n    );\n  }\n\n  return (\n    <Card className=\"shadow-lg\">\n        <CardHeader>\n            <CardTitle className=\"text-xl font-bold text-primary flex items-center\">\n                <MessageCircle className=\"mr-2 h-5 w-5\" />\n                Редактирование контактов в футере\n            </CardTitle>\n            <CardDescription className=\"text-muted-foreground\">\n                Измените ссылки и подписи для блока \"Связь с нами\" в подвале сайта.\n            </CardDescription>\n        </CardHeader>\n        <CardContent>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n                {/* VK */}\n                <div className=\"space-y-2 p-4 border border-border/30 rounded-md\">\n                    <h4 className=\"text-md font-semibold text-foreground flex items-center\"><Users className=\"mr-2 h-5 w-5 text-primary/80\"/>VK Контакт</h4>\n                    <div>\n                        <Label htmlFor=\"contact_vk_label\" className=\"text-foreground\">Текст ссылки VK</Label>\n                        <Input id=\"contact_vk_label\" {...form.register(\"contact_vk_label\")} placeholder=\"Наша беседа VK\" className=\"mt-1\" disabled={isLoading}/>\n                        {form.formState.errors.contact_vk_label && <p className=\"text-sm text-destructive mt-1\">{form.formState.errors.contact_vk_label.message}</p>}\n                    </div>\n                    <div>\n                        <Label htmlFor=\"contact_vk_url\" className=\"text-foreground\">URL ссылки VK</Label>\n                        <Input id=\"contact_vk_url\" {...form.register(\"contact_vk_url\")} placeholder=\"https://vk.me/...\" className=\"mt-1\" disabled={isLoading}/>\n                        {form.formState.errors.contact_vk_url && <p className=\"text-sm text-destructive mt-1\">{form.formState.errors.contact_vk_url.message}</p>}\n                    </div>\n                </div>\n\n                {/* Telegram Bot */}\n                <div className=\"space-y-2 p-4 border border-border/30 rounded-md\">\n                    <h4 className=\"text-md font-semibold text-foreground flex items-center\"><Bot className=\"mr-2 h-5 w-5 text-primary/80\"/>Telegram Бот</h4>\n                    <div>\n                        <Label htmlFor=\"contact_telegram_bot_label\" className=\"text-foreground\">Текст ссылки Telegram</Label>\n                        <Input id=\"contact_telegram_bot_label\" {...form.register(\"contact_telegram_bot_label\")} placeholder=\"Наш Telegram Бот\" className=\"mt-1\" disabled={isLoading}/>\n                        {form.formState.errors.contact_telegram_bot_label && <p className=\"text-sm text-destructive mt-1\">{form.formState.errors.contact_telegram_bot_label.message}</p>}\n                    </div>\n                    <div>\n                        <Label htmlFor=\"contact_telegram_bot_url\" className=\"text-foreground\">URL ссылки Telegram</Label>\n                        <Input id=\"contact_telegram_bot_url\" {...form.register(\"contact_telegram_bot_url\")} placeholder=\"https://t.me/...\" className=\"mt-1\" disabled={isLoading}/>\n                        {form.formState.errors.contact_telegram_bot_url && <p className=\"text-sm text-destructive mt-1\">{form.formState.errors.contact_telegram_bot_url.message}</p>}\n                    </div>\n                </div>\n\n                {/* Email */}\n                <div className=\"space-y-2 p-4 border border-border/30 rounded-md\">\n                     <h4 className=\"text-md font-semibold text-foreground flex items-center\"><Mail className=\"mr-2 h-5 w-5 text-primary/80\"/>Email</h4>\n                    <div>\n                        <Label htmlFor=\"contact_email_label\" className=\"text-foreground\">Текст ссылки Email</Label>\n                        <Input id=\"contact_email_label\" {...form.register(\"contact_email_label\")} placeholder=\"Email поддержки\" className=\"mt-1\" disabled={isLoading}/>\n                        {form.formState.errors.contact_email_label && <p className=\"text-sm text-destructive mt-1\">{form.formState.errors.contact_email_label.message}</p>}\n                    </div>\n                    <div>\n                        <Label htmlFor=\"contact_email_address\" className=\"text-foreground\">Адрес Email</Label>\n                        <Input id=\"contact_email_address\" type=\"email\" {...form.register(\"contact_email_address\")} placeholder=\"support@example.com\" className=\"mt-1\" disabled={isLoading}/>\n                        {form.formState.errors.contact_email_address && <p className=\"text-sm text-destructive mt-1\">{form.formState.errors.contact_email_address.message}</p>}\n                    </div>\n                </div>\n                \n                <div className=\"flex justify-end pt-4\">\n                    <Button type=\"submit\" className=\"bg-primary hover:bg-primary/90 text-primary-foreground\" disabled={isLoading || isFetching}>\n                        {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                        Сохранить контакты\n                    </Button>\n                </div>\n            </form>\n        </CardContent>\n    </Card>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}