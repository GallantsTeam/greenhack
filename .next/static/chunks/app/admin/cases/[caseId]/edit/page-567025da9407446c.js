(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1151],{2160:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]])},17313:(e,t,a)=>{"use strict";a.d(t,{Xi:()=>n,av:()=>c,j7:()=>o,tU:()=>d});var r=a(95155),s=a(12115),i=a(30064),l=a(59434);let d=i.bL,o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.B8,{ref:t,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...s})});o.displayName=i.B8.displayName;let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.l9,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...s})});n.displayName=i.l9.displayName;let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.UC,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...s})});c.displayName=i.UC.displayName},18271:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},18553:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]])},25856:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>O});var r,s=a(95155),i=a(12115),l=a(62177),d=a(90221),o=a(55594),n=a(30285),c=a(62523),m=a(85057),u=a(88539),p=a(66695),h=a(59409),x=a(47262),f=a(87481),_=a(35695),v=a(50172),g=a(18763),b=a(12543),j=a(60960),y=a(2160),N=a(18271),w=a(18553),z=a(59099),k=a(34301),S=a(77223),A=a(17313),C=a(28184),R=a(96016);let T={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};for(var I=new Uint8Array(16),L=[],F=0;F<256;++F)L.push((F+256).toString(16).slice(1));let M=function(e,t,a){if(T.randomUUID&&!t&&!e)return T.randomUUID();var s=(e=e||{}).random||(e.rng||function(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(I)})();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){a=a||0;for(var i=0;i<16;++i)t[a+i]=s[i];return t}return function(e,t=0){return(L[e[t+0]]+L[e[t+1]]+L[e[t+2]]+L[e[t+3]]+"-"+L[e[t+4]]+L[e[t+5]]+"-"+L[e[t+6]]+L[e[t+7]]+"-"+L[e[t+8]]+L[e[t+9]]+"-"+L[e[t+10]]+L[e[t+11]]+L[e[t+12]]+L[e[t+13]]+L[e[t+14]]+L[e[t+15]]).toLowerCase()}(s)},U=o.Ik({id:o.Yj().optional(),name:o.Yj().min(1,"Название приза обязательно."),prize_type:o.k5(["product_duration","balance_gh","physical_item"],{required_error:"Тип приза обязателен."}),related_product_id:o.Yj().optional().nullable(),duration_days:o.au.number().min(0,"Длительность не может быть отрицательной.").optional().nullable(),balance_gh_amount:o.au.number().min(0,"Сумма GH не может быть отрицательной.").optional().nullable(),image_url:o.Yj().url({message:"Неверный URL изображения."}).optional().or(o.eu("")).nullable(),chance:o.au.number().min(0,"Шанс должен быть от 0%").max(100,"Шанс должен быть до 100%"),sell_value_gh:o.au.number().min(0,"Цена продажи не может быть отрицательной.").optional().nullable(),data_ai_hint:o.Yj().optional().nullable()}).refine(e=>("product_duration"!==e.prize_type||!!e.related_product_id&&null!==e.duration_days&&void 0!==e.duration_days&&!(e.duration_days<=0))&&("balance_gh"!==e.prize_type||null!==e.balance_gh_amount&&void 0!==e.balance_gh_amount&&!(e.balance_gh_amount<=0)),{message:"Для типа 'Продукт (срок действия)' нужны ID продукта и длительность > 0. Для 'Баланс GH' нужна сумма > 0.",path:["prize_type"]}),D=o.Ik({id:o.ai().optional(),case_id:o.Yj(),boost_ref_id:o.Yj(),label:o.Yj(),is_active_for_case:o.zM().default(!0),override_cost_gh:o.au.number().min(0).nullable().optional(),override_chance_multiplier:o.au.number().min(0).nullable().optional(),override_description:o.Yj().nullable().optional()}),E=o.Ik({id:o.Yj(),name:o.Yj().min(3,"Название должно быть не менее 3 символов."),image_url:o.Yj().url({message:"Неверный URL изображения."}).optional().or(o.eu("")).nullable(),base_price_gh:o.au.number().min(0,"Цена не может быть отрицательной."),description:o.Yj().optional().nullable(),data_ai_hint:o.Yj().optional().nullable(),is_active:o.zM().default(!0),is_hot_offer:o.zM().default(!1),timer_enabled:o.zM().default(!1),timer_ends_at:o.Yj().nullable().optional(),prizes:o.YO(U).optional().default([]),boost_options_config:o.YO(D).optional().default([])}).refine(e=>!e.timer_enabled||e.timer_ends_at&&e.timer_ends_at.length>0,{message:"Укажите время окончания, если таймер включен.",path:["timer_ends_at"]});function O(){let{toast:e}=(0,f.dj)(),t=(0,_.useRouter)(),a=(0,_.useParams)().caseId,[r,o]=(0,i.useState)(!1),[T,I]=(0,i.useState)(!0),[L,F]=(0,i.useState)([]),U=(0,l.mN)({resolver:(0,d.u)(E),defaultValues:{id:a,name:"",image_url:"",base_price_gh:0,description:"",data_ai_hint:"",is_active:!0,is_hot_offer:!1,timer_enabled:!1,timer_ends_at:null,prizes:[],boost_options_config:[]}}),{fields:D,append:O,remove:V}=(0,l.jz)({control:U.control,name:"prizes"}),{fields:Y,replace:P}=(0,l.jz)({control:U.control,name:"boost_options_config"}),H=(0,i.useCallback)(async a=>{I(!0);try{var r;let[e,t]=await Promise.all([fetch("/api/cases/".concat(a)),fetch("/api/admin/products")]);if(!e.ok){let t=await e.json().catch(()=>({message:"Failed to fetch case data"}));throw Error(t.message)}let s=await e.json();if(!t.ok){let e=await t.json().catch(()=>({message:"Failed to fetch products"}));throw Error(e.message)}let i=await t.json();F(i);let l=null;if(s.timer_enabled&&s.timer_ends_at)try{let e=new Date(s.timer_ends_at);isNaN(e.getTime())||(l=(0,C.GP)(e,"yyyy-MM-dd'T'HH:mm"))}catch(e){console.warn("Error formatting timer_ends_at from DB:",s.timer_ends_at,e)}let d=R.z.filter(e=>"no-boost"!==e.id).map(e=>{var t;let r=null===(t=s.boost_options_config)||void 0===t?void 0:t.find(t=>t.boost_ref_id===e.id);return{id:null==r?void 0:r.id,case_id:a,boost_ref_id:e.id,label:(null==r?void 0:r.label)||e.label,is_active_for_case:!r||r.is_active_for_case,override_cost_gh:null==r?void 0:r.override_cost_gh,override_chance_multiplier:null==r?void 0:r.override_chance_multiplier,override_description:null==r?void 0:r.override_description}});U.reset({id:s.id,name:s.name,image_url:s.image_url||"",base_price_gh:s.base_price_gh,description:s.description||"",data_ai_hint:s.data_ai_hint||"",is_active:void 0===s.is_active||s.is_active,is_hot_offer:s.is_hot_offer||!1,timer_enabled:s.timer_enabled||!1,timer_ends_at:l,prizes:(null===(r=s.prizes)||void 0===r?void 0:r.map(e=>({id:e.id,name:e.name,prize_type:e.prize_type,related_product_id:e.related_product_id||null,duration_days:e.duration_days||null,balance_gh_amount:e.balance_gh_amount||null,image_url:e.image_url||"",chance:100*e.chance,sell_value_gh:e.sell_value_gh||null,data_ai_hint:e.data_ai_hint||""})))||[],boost_options_config:d}),P(d)}catch(a){console.error("Error fetching case data or products:",a),e({title:"Ошибка",description:"Не удалось загрузить данные: ".concat(a.message),variant:"destructive"}),t.push("/admin/cases")}finally{I(!1)}},[e,U,t,P]);(0,i.useEffect)(()=>{a&&H(a)},[a,H]);let B=async r=>{if(a){o(!0);try{var s,i;let l=null;if(r.timer_enabled&&r.timer_ends_at)try{l=new Date(r.timer_ends_at).toISOString().slice(0,19).replace("T"," ")}catch(e){console.warn("Invalid date format for timer_ends_at on submit:",r.timer_ends_at)}else r.timer_enabled||(l=null);let d={...r,timer_ends_at:l,prizes:null===(s=r.prizes)||void 0===s?void 0:s.map(e=>({...e,id:e.id&&!e.id.startsWith("new-")?e.id:void 0,duration_days:"product_duration"===e.prize_type&&e.duration_days?Number(e.duration_days):null,balance_gh_amount:"balance_gh"===e.prize_type&&e.balance_gh_amount?Number(e.balance_gh_amount):null,sell_value_gh:e.sell_value_gh?Number(e.sell_value_gh):null,chance:Number(e.chance)/100})),boost_options_config:null===(i=r.boost_options_config)||void 0===i?void 0:i.map(e=>({...e,override_cost_gh:null===e.override_cost_gh||void 0===e.override_cost_gh||""===e.override_cost_gh?null:Number(e.override_cost_gh),override_chance_multiplier:null===e.override_chance_multiplier||void 0===e.override_chance_multiplier||""===e.override_chance_multiplier?null:Number(e.override_chance_multiplier)}))},o=await fetch("/api/admin/cases/".concat(a),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),n=await o.json();if(!o.ok)throw Error(n.message||"Не удалось обновить кейс.");e({title:"Кейс обновлен",description:'Кейс "'.concat(r.name,'" был успешно обновлен.')}),t.push("/admin/cases")}catch(t){e({title:"Ошибка",description:t.message||"Произошла ошибка при обновлении кейса.",variant:"destructive"})}finally{o(!1)}}};return T?(0,s.jsxs)("div",{className:"flex items-center justify-center h-full",children:[(0,s.jsx)(v.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-3 text-muted-foreground",children:"Загрузка данных кейса..."})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold text-primary flex items-center",children:[(0,s.jsx)(g.A,{className:"mr-2 h-6 w-6"}),"Редактировать кейс: ",U.getValues("name")]}),(0,s.jsxs)(n.$,{onClick:()=>t.push("/admin/cases"),variant:"outline",className:"border-primary text-primary hover:bg-primary/10",children:[(0,s.jsx)(b.A,{className:"mr-2 h-4 w-4"}),"К списку кейсов"]})]}),(0,s.jsx)(p.Zp,{className:"shadow-lg",children:(0,s.jsx)(p.Wu,{className:"pt-6",children:(0,s.jsxs)("form",{onSubmit:U.handleSubmit(B),className:"space-y-6",children:[(0,s.jsxs)(A.tU,{defaultValue:"general",className:"w-full",children:[(0,s.jsxs)(A.j7,{className:"grid w-full grid-cols-3 mb-6",children:[(0,s.jsxs)(A.Xi,{value:"general",children:[(0,s.jsx)(j.A,{className:"mr-1.5 h-4 w-4"}),"Общие"]}),(0,s.jsxs)(A.Xi,{value:"prizes",children:[(0,s.jsx)(y.A,{className:"mr-1.5 h-4 w-4"}),"Призы"]}),(0,s.jsxs)(A.Xi,{value:"boosts",children:[(0,s.jsx)(N.A,{className:"mr-1.5 h-4 w-4"}),"Бусты"]})]}),(0,s.jsxs)(A.av,{value:"general",className:"space-y-4",children:[(0,s.jsx)(p.aR,{className:"px-0 py-2",children:(0,s.jsx)(p.ZB,{className:"text-xl text-foreground",children:"Основная информация"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"edit-case-id",className:"text-foreground",children:"ID Кейса (нередактируемый)"}),(0,s.jsx)(c.p,{id:"edit-case-id",value:a,className:"mt-1 bg-muted",disabled:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"edit-case-name",className:"text-foreground",children:"Название кейса"}),(0,s.jsx)(c.p,{id:"edit-case-name",...U.register("name"),placeholder:"Супер кейс",className:"mt-1",disabled:r}),U.formState.errors.name&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:U.formState.errors.name.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"edit-case-base_price_gh",className:"text-foreground",children:"Базовая цена (GH)"}),(0,s.jsx)(c.p,{id:"edit-case-base_price_gh",type:"number",step:"0.01",...U.register("base_price_gh"),placeholder:"100.00",className:"mt-1",disabled:r}),U.formState.errors.base_price_gh&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:U.formState.errors.base_price_gh.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"edit-case-image_url",className:"text-foreground",children:"URL изображения"}),(0,s.jsx)(c.p,{id:"edit-case-image_url",...U.register("image_url"),placeholder:"https://example.com/case.png",className:"mt-1",disabled:r}),U.formState.errors.image_url&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:U.formState.errors.image_url.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"edit-case-description",className:"text-foreground",children:"Описание"}),(0,s.jsx)(u.T,{id:"edit-case-description",...U.register("description"),placeholder:"Описание кейса...",className:"mt-1 min-h-[80px]",disabled:r})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"edit-case-data_ai_hint",className:"text-foreground",children:"Подсказка для AI (изображение)"}),(0,s.jsx)(c.p,{id:"edit-case-data_ai_hint",...U.register("data_ai_hint"),placeholder:"gold chest",className:"mt-1",disabled:r})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 pt-2",children:[(0,s.jsx)(l.xI,{control:U.control,name:"is_active",render:e=>{let{field:t}=e;return(0,s.jsx)(x.S,{id:"edit-case-is_active",checked:t.value,onCheckedChange:t.onChange,disabled:r})}}),(0,s.jsx)(m.Label,{htmlFor:"edit-case-is_active",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 text-foreground",children:"Кейс активен"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 pt-2",children:[(0,s.jsx)(l.xI,{control:U.control,name:"is_hot_offer",render:e=>{let{field:t}=e;return(0,s.jsx)(x.S,{id:"edit-case-is_hot_offer",checked:t.value,onCheckedChange:t.onChange,disabled:r})}}),(0,s.jsxs)(m.Label,{htmlFor:"edit-case-is_hot_offer",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 text-foreground flex items-center",children:[(0,s.jsx)(w.A,{className:"mr-2 h-4 w-4 text-orange-500"})," Горячее предложение"]})]}),(0,s.jsxs)("div",{className:"space-y-2 pt-2 border-t border-border/30",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(l.xI,{control:U.control,name:"timer_enabled",render:e=>{let{field:t}=e;return(0,s.jsx)(x.S,{id:"edit-case-timer_enabled",checked:t.value,onCheckedChange:t.onChange,disabled:r})}}),(0,s.jsxs)(m.Label,{htmlFor:"edit-case-timer_enabled",className:"text-sm font-medium leading-none text-foreground flex items-center",children:[(0,s.jsx)(z.A,{className:"mr-2 h-4 w-4 text-primary/80"}),"Включить таймер для кейса"]})]}),U.watch("timer_enabled")&&(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"edit-case-timer_ends_at",className:"text-foreground",children:"Время окончания таймера"}),(0,s.jsx)(c.p,{id:"edit-case-timer_ends_at",type:"datetime-local",...U.register("timer_ends_at"),className:"mt-1",disabled:r||!U.watch("timer_enabled")}),U.formState.errors.timer_ends_at&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-1",children:U.formState.errors.timer_ends_at.message})]})]})]}),(0,s.jsxs)(A.av,{value:"prizes",className:"space-y-4",children:[(0,s.jsxs)(p.aR,{className:"px-0 py-2 flex flex-row justify-between items-center",children:[(0,s.jsx)(p.ZB,{className:"text-xl text-foreground",children:"Призы в кейсе"}),(0,s.jsxs)(n.$,{type:"button",size:"sm",variant:"outline",className:"border-primary text-primary hover:bg-primary/10",onClick:()=>O({id:"new-".concat(M()),name:"",prize_type:"product_duration",chance:10,sell_value_gh:0,related_product_id:null,duration_days:null,balance_gh_amount:null,image_url:"",data_ai_hint:""}),disabled:r,children:[(0,s.jsx)(k.A,{className:"mr-2 h-4 w-4"})," Добавить приз"]})]}),0===D.length&&(0,s.jsx)("p",{className:"text-muted-foreground text-sm",children:"В этом кейсе еще нет призов."}),D.map((e,t)=>{var a,i,d,o,u,x,f,_,v,g,b,j,y,N,w,z,k,A,C,R,T,I,F,M,D,E,O,Y,P,H,B,G;return(0,s.jsxs)(p.Zp,{className:"p-4 border-border/50 shadow-sm",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"prizes.".concat(t,".name"),className:"text-xs text-muted-foreground",children:"Название приза"}),(0,s.jsx)(c.p,{...U.register("prizes.".concat(t,".name")),placeholder:"Название приза",className:"mt-1 h-9",disabled:r}),(null===(i=U.formState.errors.prizes)||void 0===i?void 0:null===(a=i[t])||void 0===a?void 0:a.name)&&(0,s.jsx)("p",{className:"text-xs text-destructive mt-1",children:null===(o=U.formState.errors.prizes[t])||void 0===o?void 0:null===(d=o.name)||void 0===d?void 0:d.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"prizes.".concat(t,".prize_type"),className:"text-xs text-muted-foreground",children:"Тип приза"}),(0,s.jsx)(l.xI,{control:U.control,name:"prizes.".concat(t,".prize_type"),render:e=>{let{field:a}=e;return(0,s.jsxs)(h.l6,{onValueChange:e=>{a.onChange(e),"product_duration"===e?U.setValue("prizes.".concat(t,".balance_gh_amount"),null):"balance_gh"===e&&(U.setValue("prizes.".concat(t,".related_product_id"),null),U.setValue("prizes.".concat(t,".duration_days"),null))},value:a.value,disabled:r,children:[(0,s.jsx)(h.bq,{className:"w-full mt-1 h-9",children:(0,s.jsx)(h.yv,{placeholder:"Выберите тип"})}),(0,s.jsxs)(h.gC,{children:[(0,s.jsx)(h.eb,{value:"product_duration",children:"Продукт (срок)"}),(0,s.jsx)(h.eb,{value:"balance_gh",children:"Баланс GH"}),(0,s.jsx)(h.eb,{value:"physical_item",disabled:!0,children:"Физический товар (скоро)"})]})]})}}),(null===(x=U.formState.errors.prizes)||void 0===x?void 0:null===(u=x[t])||void 0===u?void 0:u.prize_type)&&(0,s.jsx)("p",{className:"text-xs text-destructive mt-1",children:null===(_=U.formState.errors.prizes[t])||void 0===_?void 0:null===(f=_.prize_type)||void 0===f?void 0:f.message})]})]}),"product_duration"===U.watch("prizes.".concat(t,".prize_type"))&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"prizes.".concat(t,".related_product_id"),className:"text-xs text-muted-foreground",children:"Продукт"}),(0,s.jsx)(l.xI,{control:U.control,name:"prizes.".concat(t,".related_product_id"),render:e=>{let{field:t}=e;return(0,s.jsxs)(h.l6,{onValueChange:t.onChange,value:t.value||"",disabled:r||0===L.length,children:[(0,s.jsx)(h.bq,{className:"w-full mt-1 h-9",children:(0,s.jsx)(h.yv,{placeholder:0===L.length?"Нет продуктов":"Выберите продукт"})}),(0,s.jsx)(h.gC,{children:L.map(e=>(0,s.jsx)(h.eb,{value:e.id,children:e.name},e.id))})]})}}),(null===(g=U.formState.errors.prizes)||void 0===g?void 0:null===(v=g[t])||void 0===v?void 0:v.related_product_id)&&(0,s.jsx)("p",{className:"text-xs text-destructive mt-1",children:null===(j=U.formState.errors.prizes[t])||void 0===j?void 0:null===(b=j.related_product_id)||void 0===b?void 0:b.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"prizes.".concat(t,".duration_days"),className:"text-xs text-muted-foreground",children:"Длительность (дни)"}),(0,s.jsx)(c.p,{type:"number",...U.register("prizes.".concat(t,".duration_days")),placeholder:"7",className:"mt-1 h-9",disabled:r}),(null===(N=U.formState.errors.prizes)||void 0===N?void 0:null===(y=N[t])||void 0===y?void 0:y.duration_days)&&(0,s.jsx)("p",{className:"text-xs text-destructive mt-1",children:null===(z=U.formState.errors.prizes[t])||void 0===z?void 0:null===(w=z.duration_days)||void 0===w?void 0:w.message})]})]}),"balance_gh"===U.watch("prizes.".concat(t,".prize_type"))&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)(m.Label,{htmlFor:"prizes.".concat(t,".balance_gh_amount"),className:"text-xs text-muted-foreground",children:"Сумма GH"}),(0,s.jsx)(c.p,{type:"number",step:"0.01",...U.register("prizes.".concat(t,".balance_gh_amount")),placeholder:"50.00",className:"mt-1 h-9",disabled:r}),(null===(A=U.formState.errors.prizes)||void 0===A?void 0:null===(k=A[t])||void 0===k?void 0:k.balance_gh_amount)&&(0,s.jsx)("p",{className:"text-xs text-destructive mt-1",children:null===(R=U.formState.errors.prizes[t])||void 0===R?void 0:null===(C=R.balance_gh_amount)||void 0===C?void 0:C.message})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"prizes.".concat(t,".image_url"),className:"text-xs text-muted-foreground",children:"URL изображения приза"}),(0,s.jsx)(c.p,{...U.register("prizes.".concat(t,".image_url")),placeholder:"https://...",className:"mt-1 h-9",disabled:r}),(null===(I=U.formState.errors.prizes)||void 0===I?void 0:null===(T=I[t])||void 0===T?void 0:T.image_url)&&(0,s.jsx)("p",{className:"text-xs text-destructive mt-1",children:null===(M=U.formState.errors.prizes[t])||void 0===M?void 0:null===(F=M.image_url)||void 0===F?void 0:F.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"prizes.".concat(t,".chance"),className:"text-xs text-muted-foreground",children:"Шанс (0-100%)"}),(0,s.jsx)(c.p,{type:"number",step:"0.01",min:"0",max:"100",...U.register("prizes.".concat(t,".chance")),placeholder:"10",className:"mt-1 h-9",disabled:r}),(null===(E=U.formState.errors.prizes)||void 0===E?void 0:null===(D=E[t])||void 0===D?void 0:D.chance)&&(0,s.jsx)("p",{className:"text-xs text-destructive mt-1",children:null===(Y=U.formState.errors.prizes[t])||void 0===Y?void 0:null===(O=Y.chance)||void 0===O?void 0:O.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"prizes.".concat(t,".sell_value_gh"),className:"text-xs text-muted-foreground",children:"Цена продажи (GH)"}),(0,s.jsx)(c.p,{type:"number",step:"0.01",...U.register("prizes.".concat(t,".sell_value_gh")),placeholder:"10.00",className:"mt-1 h-9",disabled:r}),(null===(H=U.formState.errors.prizes)||void 0===H?void 0:null===(P=H[t])||void 0===P?void 0:P.sell_value_gh)&&(0,s.jsx)("p",{className:"text-xs text-destructive mt-1",children:null===(G=U.formState.errors.prizes[t])||void 0===G?void 0:null===(B=G.sell_value_gh)||void 0===B?void 0:B.message})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"prizes.".concat(t,".data_ai_hint"),className:"text-xs text-muted-foreground",children:"AI подсказка (изображение)"}),(0,s.jsx)(c.p,{...U.register("prizes.".concat(t,".data_ai_hint")),placeholder:"gold coin",className:"mt-1 h-9",disabled:r})]}),(0,s.jsx)("div",{className:"mt-3 flex justify-end",children:(0,s.jsxs)(n.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>V(t),className:"text-destructive hover:bg-destructive/10 h-8",disabled:r,children:[(0,s.jsx)(S.A,{className:"mr-1 h-4 w-4"})," Удалить приз"]})})]},e.id)})]}),(0,s.jsxs)(A.av,{value:"boosts",className:"space-y-4",children:[(0,s.jsxs)(p.aR,{className:"px-0 py-2",children:[(0,s.jsx)(p.ZB,{className:"text-xl text-foreground",children:"Настройка Бустов для Кейса"}),(0,s.jsx)(p.BT,{className:"text-muted-foreground",children:"Включите или выключите бусты для этого кейса и, при необходимости, переопределите их стандартные значения. Если поля для переопределения оставить пустыми, будут использованы значения по умолчанию."})]}),Y.map((e,t)=>{var a,i,d,o;return(0,s.jsxs)(p.Zp,{className:"p-4 border-border/50 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)(m.Label,{htmlFor:"boost_options_config.".concat(t,".is_active_for_case"),className:"text-sm font-medium text-foreground flex items-center gap-2",children:[(0,s.jsx)(l.xI,{name:"boost_options_config.".concat(t,".is_active_for_case"),control:U.control,render:e=>{let{field:a}=e;return(0,s.jsx)(x.S,{id:"boost_options_config.".concat(t,".is_active_for_case"),checked:a.value,onCheckedChange:a.onChange,disabled:r})}}),e.label]}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Ref ID: ",e.boost_ref_id]})]}),U.watch("boost_options_config.".concat(t,".is_active_for_case"))&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"boost_options_config.".concat(t,".override_cost_gh"),className:"text-xs text-muted-foreground",children:"Новая цена (GH)"}),(0,s.jsx)(c.p,{type:"number",step:"0.01",...U.register("boost_options_config.".concat(t,".override_cost_gh")),placeholder:"Стандарт: ".concat(null!==(d=null===(a=R.z.find(t=>t.id===e.boost_ref_id))||void 0===a?void 0:a.cost)&&void 0!==d?d:"N/A"),className:"mt-1 h-9",disabled:r})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{htmlFor:"boost_options_config.".concat(t,".override_chance_multiplier"),className:"text-xs text-muted-foreground",children:"Новый множитель шанса"}),(0,s.jsx)(c.p,{type:"number",step:"0.01",...U.register("boost_options_config.".concat(t,".override_chance_multiplier")),placeholder:"Стандарт: ".concat(null!==(o=null===(i=R.z.find(t=>t.id===e.boost_ref_id))||void 0===i?void 0:i.chanceMultiplier)&&void 0!==o?o:"N/A"),className:"mt-1 h-9",disabled:r})]})]})]},e.id)})]})]}),(0,s.jsx)("div",{className:"flex justify-end pt-6 border-t border-border/50",children:(0,s.jsxs)(n.$,{type:"submit",className:"bg-primary hover:bg-primary/90 text-primary-foreground",disabled:r||T,children:[r?(0,s.jsx)(v.A,{className:"mr-2 h-4 w-4 animate-spin"}):null,r?"Сохранение...":"Сохранить изменения"]})})]})})})]})}},30285:(e,t,a)=>{"use strict";a.d(t,{$:()=>n,r:()=>o});var r=a(95155),s=a(12115),i=a(99708),l=a(74466),d=a(59434);let o=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-primary bg-transparent text-primary hover:bg-primary/10 hover:text-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),n=s.forwardRef((e,t)=>{let{className:a,variant:s,size:l,asChild:n=!1,...c}=e,m=n?i.DX:"button";return(0,r.jsx)(m,{className:(0,d.cn)(o({variant:s,size:l,className:a})),ref:t,...c})});n.displayName="Button"},34301:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},46465:(e,t,a)=>{Promise.resolve().then(a.bind(a,25856))},47262:(e,t,a)=>{"use strict";a.d(t,{S:()=>o});var r=a(95155),s=a(12115),i=a(76981),l=a(10518),d=a(59434);let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.bL,{ref:t,className:(0,d.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...s,children:(0,r.jsx)(i.C1,{className:(0,d.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})})});o.displayName=i.bL.displayName},59099:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]])},59409:(e,t,a)=>{"use strict";a.d(t,{bq:()=>u,eb:()=>f,gC:()=>x,l6:()=>c,yv:()=>m});var r=a(95155),s=a(12115),i=a(31992),l=a(79556),d=a(77381),o=a(10518),n=a(59434);let c=i.bL;i.YJ;let m=i.WT,u=s.forwardRef((e,t)=>{let{className:a,children:s,...d}=e;return(0,r.jsxs)(i.l9,{ref:t,className:(0,n.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...d,children:[s,(0,r.jsx)(i.In,{asChild:!0,children:(0,r.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=i.l9.displayName;let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.PP,{ref:t,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(d.A,{className:"h-4 w-4"})})});p.displayName=i.PP.displayName;let h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.wn,{ref:t,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})});h.displayName=i.wn.displayName;let x=s.forwardRef((e,t)=>{let{className:a,children:s,position:l="popper",...d}=e;return(0,r.jsx)(i.ZL,{children:(0,r.jsxs)(i.UC,{ref:t,className:(0,n.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...d,children:[(0,r.jsx)(p,{}),(0,r.jsx)(i.LM,{className:(0,n.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(h,{})]})})});x.displayName=i.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.JU,{ref:t,className:(0,n.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...s})}).displayName=i.JU.displayName;let f=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.jsxs)(i.q7,{ref:t,className:(0,n.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(i.VF,{children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})}),(0,r.jsx)(i.p4,{children:s})]})});f.displayName=i.q7.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.wv,{ref:t,className:(0,n.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=i.wv.displayName},59434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>i});var r=a(52596),s=a(39688);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}},62523:(e,t,a)=>{"use strict";a.d(t,{p:()=>l});var r=a(95155),s=a(12115),i=a(59434);let l=s.forwardRef((e,t)=>{let{className:a,type:s,...l}=e;return(0,r.jsx)("input",{type:s,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});l.displayName="Input"},66695:(e,t,a)=>{"use strict";a.d(t,{BT:()=>n,Wu:()=>c,ZB:()=>o,Zp:()=>l,aR:()=>d,wL:()=>m});var r=a(95155),s=a(12115),i=a(59434);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});l.displayName="Card";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...s})});d.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,i.cn)("text-xl font-normal uppercase tracking-wider leading-none",a),...s})});o.displayName="CardTitle";let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...s})});n.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent";let m=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",a),...s})});m.displayName="CardFooter"},77223:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},85057:(e,t,a)=>{"use strict";a.d(t,{Label:()=>n});var r=a(95155),s=a(12115),i=a(40968),l=a(74466),d=a(59434);let o=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.b,{ref:t,className:(0,d.cn)(o(),a),...s})});n.displayName=i.b.displayName},87481:(e,t,a)=>{"use strict";a.d(t,{dj:()=>u});var r=a(12115);let s=0,i=new Map,l=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},d=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?l(a):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],n={toasts:[]};function c(e){n=d(n,e),o.forEach(e=>{e(n)})}function m(e){let{...t}=e,a=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function u(){let[e,t]=r.useState(n);return r.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},88539:(e,t,a)=>{"use strict";a.d(t,{T:()=>l});var r=a(95155),s=a(12115),i=a(59434);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...s})});l.displayName="Textarea"},96016:(e,t,a)=>{"use strict";a.d(t,{Y:()=>s,z:()=>r});let r=[{id:"no-boost",label:"Стандарт",cost:0,chanceMultiplier:1,description:"Базовый шанс."},{id:"boost10",label:"+10%",cost:10,chanceMultiplier:1.1,description:"Шанс x1.10"},{id:"boost50",label:"+50%",cost:100,chanceMultiplier:1.5,description:"Шанс x1.50"},{id:"boost70",label:"+70%",cost:1e3,chanceMultiplier:1.7,description:"Шанс x1.70"}],s="warface-allin"}},e=>{var t=t=>e(e.s=t);e.O(0,[4277,7576,5521,5756,9205,8897,8991,7336,8441,1684,7358],()=>t(46465)),_N_E=e.O()}]);