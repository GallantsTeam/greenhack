(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3096],{30285:(e,s,r)=>{"use strict";r.d(s,{$:()=>o,r:()=>n});var t=r(95155),a=r(12115),i=r(99708),l=r(74466),d=r(59434);let n=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-primary bg-transparent text-primary hover:bg-primary/10 hover:text-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef((e,s)=>{let{className:r,variant:a,size:l,asChild:o=!1,...c}=e,m=o?i.DX:"button";return(0,t.jsx)(m,{className:(0,d.cn)(n({variant:a,size:l,className:r})),ref:s,...c})});o.displayName="Button"},30746:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>T});var t=r(95155),a=r(12115),i=r(62177),l=r(90221),d=r(55594),n=r(30285),o=r(62523),c=r(85057),m=r(88539),u=r(66695),x=r(47262),f=r(87481),p=r(35695),h=r(82733),g=r(12543),b=r(53054),_=r(15300),j=r(88390),v=r(79311),N=r(93223),y=r(18553),w=r(59099),S=r(50172);let A=d.Ik({id:d.Yj().min(3,"ID кейса должен быть не менее 3 символов.").regex(/^[a-z0-9]+(?:-[a-z0-9]+)*$/,"ID может содержать только строчные буквы, цифры и дефисы."),name:d.Yj().min(3,"Название должно быть не менее 3 символов."),image_url:d.Yj().url({message:"Неверный URL изображения."}).optional().or(d.eu("")),base_price_gh:d.au.number().min(0,"Цена не может быть отрицательной."),description:d.Yj().optional().nullable(),data_ai_hint:d.Yj().optional().nullable(),is_active:d.zM().default(!0),is_hot_offer:d.zM().default(!1),timer_enabled:d.zM().default(!1),timer_ends_at:d.Yj().nullable().optional()}).refine(e=>!e.timer_enabled||e.timer_ends_at&&e.timer_ends_at.length>0,{message:"Укажите время окончания, если таймер включен.",path:["timer_ends_at"]});function T(){let{toast:e}=(0,f.dj)(),s=(0,p.useRouter)(),[r,d]=(0,a.useState)(!1),T=(0,i.mN)({resolver:(0,l.u)(A),defaultValues:{id:"",name:"",image_url:"",base_price_gh:0,description:"",data_ai_hint:"",is_active:!0,is_hot_offer:!1,timer_enabled:!1,timer_ends_at:null}}),k=async r=>{d(!0);let t={...r,timer_ends_at:r.timer_enabled?r.timer_ends_at:null};try{let a=await fetch("/api/admin/cases",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),i=await a.json();if(!a.ok)throw Error(i.message||"Не удалось добавить кейс.");e({title:"Кейс добавлен",description:'Кейс "'.concat(r.name,'" был успешно создан. Теперь вы можете добавить призы на странице редактирования.')}),s.push("/admin/cases")}catch(s){e({title:"Ошибка",description:s.message||"Произошла ошибка при добавлении кейса.",variant:"destructive"})}finally{d(!1)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold text-primary flex items-center",children:[(0,t.jsx)(h.A,{className:"mr-2 h-6 w-6"}),"Добавить новый кейс"]}),(0,t.jsxs)(n.$,{onClick:()=>s.push("/admin/cases"),variant:"outline",className:"border-primary text-primary hover:bg-primary/10",children:[(0,t.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"К списку кейсов"]})]}),(0,t.jsxs)(u.Zp,{className:"shadow-lg",children:[(0,t.jsxs)(u.aR,{children:[(0,t.jsx)(u.ZB,{className:"text-xl text-foreground",children:"Информация о кейсе"}),(0,t.jsx)(u.BT,{className:"text-muted-foreground",children:"Заполните детали нового кейса. Призы добавляются на этапе редактирования."})]}),(0,t.jsx)(u.Wu,{children:(0,t.jsxs)("form",{onSubmit:T.handleSubmit(k),className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(c.Label,{htmlFor:"case-id",className:"text-foreground flex items-center",children:[(0,t.jsx)(b.A,{className:"mr-2 h-4 w-4 text-primary/80"}),"ID Кейса (уникальный)"]}),(0,t.jsx)(o.p,{id:"case-id",...T.register("id"),placeholder:"например, main-daily-case",className:"mt-1",disabled:r}),T.formState.errors.id&&(0,t.jsx)("p",{className:"text-sm text-destructive mt-1",children:T.formState.errors.id.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(c.Label,{htmlFor:"case-name",className:"text-foreground flex items-center",children:[(0,t.jsx)(_.A,{className:"mr-2 h-4 w-4 text-primary/80"}),"Название кейса"]}),(0,t.jsx)(o.p,{id:"case-name",...T.register("name"),placeholder:"Ежедневный кейс удачи",className:"mt-1",disabled:r}),T.formState.errors.name&&(0,t.jsx)("p",{className:"text-sm text-destructive mt-1",children:T.formState.errors.name.message})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(c.Label,{htmlFor:"case-base_price_gh",className:"text-foreground flex items-center",children:[(0,t.jsx)(j.A,{className:"mr-2 h-4 w-4 text-primary/80"}),"Базовая цена (GH)"]}),(0,t.jsx)(o.p,{id:"case-base_price_gh",type:"number",step:"0.01",...T.register("base_price_gh"),placeholder:"100.00",className:"mt-1",disabled:r}),T.formState.errors.base_price_gh&&(0,t.jsx)("p",{className:"text-sm text-destructive mt-1",children:T.formState.errors.base_price_gh.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(c.Label,{htmlFor:"case-image_url",className:"text-foreground flex items-center",children:[(0,t.jsx)(v.A,{className:"mr-2 h-4 w-4 text-primary/80"}),"URL изображения"]}),(0,t.jsx)(o.p,{id:"case-image_url",...T.register("image_url"),placeholder:"https://example.com/case-image.png",className:"mt-1",disabled:r}),T.formState.errors.image_url&&(0,t.jsx)("p",{className:"text-sm text-destructive mt-1",children:T.formState.errors.image_url.message})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(c.Label,{htmlFor:"case-description",className:"text-foreground flex items-center",children:[(0,t.jsx)(_.A,{className:"mr-2 h-4 w-4 text-primary/80"}),"Описание"]}),(0,t.jsx)(m.T,{id:"case-description",...T.register("description"),placeholder:"Краткое описание кейса...",className:"mt-1 min-h-[80px]",disabled:r}),T.formState.errors.description&&(0,t.jsx)("p",{className:"text-sm text-destructive mt-1",children:T.formState.errors.description.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(c.Label,{htmlFor:"case-data_ai_hint",className:"text-foreground flex items-center",children:[(0,t.jsx)(v.A,{className:"mr-2 h-4 w-4 text-primary/80"}),"Подсказка для AI (для изображения)"]}),(0,t.jsx)(o.p,{id:"case-data_ai_hint",...T.register("data_ai_hint"),placeholder:"например, treasure box",className:"mt-1",disabled:r})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.xI,{control:T.control,name:"is_active",render:e=>{let{field:s}=e;return(0,t.jsx)(x.S,{id:"is_active",checked:s.value,onCheckedChange:s.onChange,disabled:r})}}),(0,t.jsxs)(c.Label,{htmlFor:"is_active",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 text-foreground flex items-center",children:[(0,t.jsx)(N.A,{className:"mr-2 h-4 w-4 text-primary/80"}),"Кейс активен"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.xI,{control:T.control,name:"is_hot_offer",render:e=>{let{field:s}=e;return(0,t.jsx)(x.S,{id:"is_hot_offer",checked:s.value,onCheckedChange:s.onChange,disabled:r})}}),(0,t.jsxs)(c.Label,{htmlFor:"is_hot_offer",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 text-foreground flex items-center",children:[(0,t.jsx)(y.A,{className:"mr-2 h-4 w-4 text-orange-500"}),"Горячее предложение"]})]}),(0,t.jsxs)("div",{className:"space-y-2 pt-2 border-t border-border/30",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.xI,{control:T.control,name:"timer_enabled",render:e=>{let{field:s}=e;return(0,t.jsx)(x.S,{id:"timer_enabled",checked:s.value,onCheckedChange:s.onChange,disabled:r})}}),(0,t.jsxs)(c.Label,{htmlFor:"timer_enabled",className:"text-sm font-medium leading-none text-foreground flex items-center",children:[(0,t.jsx)(w.A,{className:"mr-2 h-4 w-4 text-primary/80"}),"Включить таймер для кейса"]})]}),T.watch("timer_enabled")&&(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Label,{htmlFor:"timer_ends_at",className:"text-foreground",children:"Время окончания таймера"}),(0,t.jsx)(o.p,{id:"timer_ends_at",type:"datetime-local",...T.register("timer_ends_at"),className:"mt-1",disabled:r||!T.watch("timer_enabled")}),T.formState.errors.timer_ends_at&&(0,t.jsx)("p",{className:"text-sm text-destructive mt-1",children:T.formState.errors.timer_ends_at.message})]})]}),(0,t.jsx)("div",{className:"flex justify-end pt-4",children:(0,t.jsxs)(n.$,{type:"submit",className:"bg-primary hover:bg-primary/90 text-primary-foreground",disabled:r,children:[r?(0,t.jsx)(S.A,{className:"mr-2 h-4 w-4 animate-spin"}):null,r?"Добавление...":"Добавить кейс"]})})]})})]})]})}},31420:(e,s,r)=>{Promise.resolve().then(r.bind(r,30746))},47262:(e,s,r)=>{"use strict";r.d(s,{S:()=>n});var t=r(95155),a=r(12115),i=r(76981),l=r(10518),d=r(59434);let n=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)(i.bL,{ref:s,className:(0,d.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...a,children:(0,t.jsx)(i.C1,{className:(0,d.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(l.A,{className:"h-4 w-4"})})})});n.displayName=i.bL.displayName},59434:(e,s,r)=>{"use strict";r.d(s,{cn:()=>i});var t=r(52596),a=r(39688);function i(){for(var e=arguments.length,s=Array(e),r=0;r<e;r++)s[r]=arguments[r];return(0,a.QP)((0,t.$)(s))}},62523:(e,s,r)=>{"use strict";r.d(s,{p:()=>l});var t=r(95155),a=r(12115),i=r(59434);let l=a.forwardRef((e,s)=>{let{className:r,type:a,...l}=e;return(0,t.jsx)("input",{type:a,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...l})});l.displayName="Input"},66695:(e,s,r)=>{"use strict";r.d(s,{BT:()=>o,Wu:()=>c,ZB:()=>n,Zp:()=>l,aR:()=>d,wL:()=>m});var t=r(95155),a=r(12115),i=r(59434);let l=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});l.displayName="Card";let d=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",r),...a})});d.displayName="CardHeader";let n=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("h3",{ref:s,className:(0,i.cn)("text-xl font-normal uppercase tracking-wider leading-none",r),...a})});n.displayName="CardTitle";let o=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("p",{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",r),...a})});o.displayName="CardDescription";let c=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("p-6 pt-0",r),...a})});c.displayName="CardContent";let m=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",r),...a})});m.displayName="CardFooter"},85057:(e,s,r)=>{"use strict";r.d(s,{Label:()=>o});var t=r(95155),a=r(12115),i=r(40968),l=r(74466),d=r(59434);let n=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)(i.b,{ref:s,className:(0,d.cn)(n(),r),...a})});o.displayName=i.b.displayName},87481:(e,s,r)=>{"use strict";r.d(s,{dj:()=>u});var t=r(12115);let a=0,i=new Map,l=e=>{if(i.has(e))return;let s=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,s)},d=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=s;return r?l(r):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},n=[],o={toasts:[]};function c(e){o=d(o,e),n.forEach(e=>{e(o)})}function m(e){let{...s}=e,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),t=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...s,id:r,open:!0,onOpenChange:e=>{e||t()}}}),{id:r,dismiss:t,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function u(){let[e,s]=t.useState(o);return t.useEffect(()=>(n.push(s),()=>{let e=n.indexOf(s);e>-1&&n.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},88539:(e,s,r)=>{"use strict";r.d(s,{T:()=>l});var t=r(95155),a=r(12115),i=r(59434);let l=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...a})});l.displayName="Textarea"}},e=>{var s=s=>e(e.s=s);e.O(0,[4277,5521,363,8441,1684,7358],()=>s(31420)),_N_E=e.O()}]);