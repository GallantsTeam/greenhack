(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9827],{2160:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]])},8376:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},10518:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},11133:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},11275:(e,t,a)=>{"use strict";a.d(t,{X:()=>l});var r=a(12115),s=a(52712);function l(e){let[t,a]=r.useState(void 0);return(0,s.N)(()=>{if(e){a({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let r,s;if(!Array.isArray(t)||!t.length)return;let l=t[0];if("borderBoxSize"in l){let e=l.borderBoxSize,t=Array.isArray(e)?e[0]:e;r=t.inlineSize,s=t.blockSize}else r=e.offsetWidth,s=e.offsetHeight;a({width:r,height:s})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}a(void 0)},[e]),t}},12543:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},12867:(e,t,a)=>{Promise.resolve().then(a.bind(a,51237))},25318:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},30285:(e,t,a)=>{"use strict";a.d(t,{$:()=>d,r:()=>o});var r=a(95155),s=a(12115),l=a(99708),n=a(74466),i=a(59434);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-primary bg-transparent text-primary hover:bg-primary/10 hover:text-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:a,variant:s,size:n,asChild:d=!1,...c}=e,u=d?l.DX:"button";return(0,r.jsx)(u,{className:(0,i.cn)(o({variant:s,size:n,className:a})),ref:t,...c})});d.displayName="Button"},35695:(e,t,a)=>{"use strict";var r=a(18999);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},40283:(e,t,a)=>{"use strict";a.d(t,{A:()=>d,AuthProviderClient:()=>i,O:()=>o});var r=a(95155),s=a(12115),l=a(35695);let n=(0,s.createContext)(void 0),i=e=>{let{children:t}=e;return(0,r.jsx)(r.Fragment,{children:t})},o=e=>{let{children:t}=e,[a,i]=(0,s.useState)(null),[o,d]=(0,s.useState)(!0),c=(0,l.useRouter)(),u=(0,l.usePathname)(),m=e=>{if(e&&e.id&&e.username&&e.email){let t=0;return"string"==typeof e.balance?t=parseFloat(e.balance):"number"==typeof e.balance&&(t=e.balance),isNaN(t)&&(t=0),{...e,balance:t}}return null},f=(0,s.useCallback)(async e=>{try{let t=await fetch("/api/user/".concat(e,"/details"));if(!t.ok){let a=await t.json().catch(()=>({message:"Failed to fetch updated user details"}));return console.warn("Failed to fetch updated user details for user ".concat(e,": ").concat(a.message||t.statusText)),null}let a=await t.json(),r=m(a.user);if(r)return i(r),localStorage.setItem("currentUser",JSON.stringify(r)),r;return null}catch(e){return console.error("Error fetching user details:",e),null}},[]);(0,s.useEffect)(()=>{(async()=>{d(!0);let e=localStorage.getItem("currentUser");if(e)try{let t=JSON.parse(e),a=m(t);if(a&&a.id){let e=await f(a.id);e?i(e):(i(a),console.warn("Used stored user details as fresh fetch failed."))}else localStorage.removeItem("currentUser"),i(null)}catch(e){console.error("Failed to parse or refresh stored user:",e),localStorage.removeItem("currentUser"),i(null)}d(!1)})()},[f]);let h=(0,s.useCallback)(async(e,t)=>{d(!0);try{let a=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emailOrLogin:e,password:t})}),r=await a.json();if(!a.ok)throw Error(r.message||"Login failed");if(r.user&&r.user.id){if(await f(r.user.id))c.push("/account");else{let e=m(r.user);if(e)i(e),localStorage.setItem("currentUser",JSON.stringify(e)),c.push("/account");else throw Error("Invalid user data received from login.")}}else throw Error("Login response did not include user ID.")}catch(e){throw console.error("Login error in AuthContext:",e),i(null),localStorage.removeItem("currentUser"),e}finally{d(!1)}},[c,f]),p=(0,s.useCallback)(async(e,t,a,r)=>{d(!0);try{let s=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:t,password:a,referralCode:r})}),l=await s.json();if(!s.ok)throw Error(l.message||"Registration failed");c.push("/auth/login?registrationSuccess=true")}catch(e){throw console.error("Registration error in AuthContext:",e),e}finally{d(!1)}},[c]),x=(0,s.useCallback)(()=>{i(null),localStorage.removeItem("currentUser"),u.startsWith("/account")||u.startsWith("/admin")?c.push("/auth/login"):c.push("/")},[c,u]);return(0,r.jsx)(n.Provider,{value:{currentUser:a,loading:o,login:h,register:p,logout:x,fetchUserDetails:f,setCurrentUser:i},children:t})},d=()=>{let e=(0,s.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},40968:(e,t,a)=>{"use strict";a.d(t,{b:()=>i});var r=a(12115),s=a(63655),l=a(95155),n=r.forwardRef((e,t)=>(0,l.jsx)(s.sG.label,{...e,ref:t,onMouseDown:t=>{var a;t.target.closest("button, input, select, textarea")||(null===(a=e.onMouseDown)||void 0===a||a.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var i=n},45503:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var r=a(12115);function s(e){let t=r.useRef({value:e,previous:e});return r.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}},47262:(e,t,a)=>{"use strict";a.d(t,{S:()=>o});var r=a(95155),s=a(12115),l=a(76981),n=a(10518),i=a(59434);let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.bL,{ref:t,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...s,children:(0,r.jsx)(l.C1,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(n.A,{className:"h-4 w-4"})})})});o.displayName=l.bL.displayName},50172:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},51237:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>S});var r=a(95155),s=a(12115),l=a(35695),n=a(66766),i=a(30285),o=a(66695),d=a(54165),c=a(8376),u=a(88390),m=a(50172),f=a(11133),h=a(12543),p=a(94815);let x=(0,a(40157).A)("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);var g=a(2160),y=a(87481),b=a(40283),v=a(96016),w=a(47262),j=a(85057),N=a(6874),_=a.n(N);let k=e=>{let{endsAt:t,onTimerEnd:a}=e,[l,n]=(0,s.useState)(null);return((0,s.useEffect)(()=>{if(!t){n(null);return}let e=()=>{let e=+new Date(t)-+new Date,r=null;if(e>0){let t=Math.floor(e/864e5),a=Math.floor(e/36e5%24),s=Math.floor(e/1e3/60%60),l=Math.floor(e/1e3%60);r="".concat(t>0?t+"д ":"").concat(a.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0"))}else r="Время истекло!",a&&a();n(r)};e();let r=setInterval(e,1e3);return()=>clearInterval(r)},[t,a]),l)?"Время истекло!"===l?(0,r.jsx)("p",{className:"text-sm font-semibold text-destructive text-center mt-2",children:l}):(0,r.jsxs)("div",{className:"text-center mt-2",children:[(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"До конца:"}),(0,r.jsx)("p",{className:"text-lg font-bold text-primary",children:l})]}):null};function S(){let e=(0,l.useParams)(),t=(0,l.useRouter)(),a=e.caseId,{toast:N}=(0,y.dj)(),{currentUser:S,fetchUserDetails:A}=(0,b.A)(),[M,C]=(0,s.useState)(null),[z,E]=(0,s.useState)(!0),[T,I]=(0,s.useState)(null),[O,R]=(0,s.useState)(!1),[P,D]=(0,s.useState)(null),[L,F]=(0,s.useState)(!1),[U,H]=(0,s.useState)([]),[G,B]=(0,s.useState)([]),J=(0,s.useRef)(null),[q,W]=(0,s.useState)(0),[$,Z]=(0,s.useState)(null),[V,X]=(0,s.useState)(!1),[K,Y]=(0,s.useState)(!1),[Q,ee]=(0,s.useState)([]);(0,s.useEffect)(()=>{(async()=>{if(a){E(!0),I(null);try{let e=await fetch("/api/cases/".concat(a));if(!e.ok){let t=await e.json().catch(()=>({message:"Кейс не найден или произошла ошибка."}));throw Error(t.message)}let t=await e.json();C(t),W(t.base_price_gh),t.timer_enabled&&t.timer_ends_at&&new Date(t.timer_ends_at)<=new Date&&Y(!0);let r=t.boost_options_config||[],s=v.z.filter(e=>"no-boost"!==e.id).map(e=>{let t=r.find(t=>t.boost_ref_id===e.id);if(t&&t.is_active_for_case){var a,s;return{...e,label:t.label||e.label,cost:null!==(a=t.override_cost_gh)&&void 0!==a?a:e.cost,chanceMultiplier:null!==(s=t.override_chance_multiplier)&&void 0!==s?s:e.chanceMultiplier,description:t.override_description||e.description}}return!t&&e.isActiveByDefault?e:null}).filter(Boolean);if(ee(s),t.prizes&&t.prizes.length>0){let e=[],a=Math.max(35*t.prizes.length,180),r=0;for(;r<a;)for(let s of[...t.prizes].sort(()=>.5-Math.random()))if(e.push({...s,uniqueKey:"".concat(s.id,"-").concat(r)}),++r>=a)break;B(e)}else I("В этом кейсе нет призов.")}catch(e){I(e.message||"Не удалось загрузить данные кейса.")}finally{E(!1)}}})()},[a]),(0,s.useEffect)(()=>{if(J.current&&G.length>0&&!O&&!L){let e=Math.floor(G.length/3),t=Math.floor(Math.random()*e),a=Math.max(0,(e+t)*108-J.current.offsetWidth/2+54);J.current.scrollTo({left:a,behavior:"auto"})}},[G,z,O,L]),(0,s.useEffect)(()=>{if(M){let e=U.reduce((e,t)=>e+t.cost,0);W(M.base_price_gh+e)}},[U,M]);let et=(e,t)=>{H(a=>t?[...a,e]:a.filter(t=>t.id!==e.id))},ea=async()=>{if(!O&&G.length&&J.current&&S&&M){if(K){N({title:"Время вышло",description:"К сожалению, время для открытия этого кейса истекло.",variant:"destructive"});return}if(S.balance<q){N({title:"Недостаточно средств",description:"Требуется ".concat(q.toFixed(2)," GH. Ваш баланс: ").concat(S.balance.toFixed(2)," GH"),variant:"destructive"});return}R(!0),D(null),F(!1),Z(null);try{let e=await fetch("/api/case/open",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:S.id,caseId:M.id,selectedBoostIds:U.map(e=>e.id)})}),t=await e.json();if(!e.ok){N({title:"Ошибка открытия",description:t.message||"Не удалось открыть кейс.",variant:"destructive"}),t.updatedUser&&S&&A&&A(S.id),R(!1);return}let a=t.winningPrize;D(a),Z(t.caseOpeningId),t.updatedUser&&S&&A&&A(S.id);let r=J.current,s=G.reduce((e,t,r)=>(t.id===a.id&&e.push(r),e),[]),l=-1;if(s.length>0){let e=Math.floor(.6*G.length),t=s.filter(t=>t>=e);l=t.length>0?t[Math.floor(Math.random()*t.length)]:s[Math.floor(Math.random()*s.length)]}else console.error("CRITICAL: Server winning prize ID ".concat(a.id," (").concat(a.name,") not found in client-side rouletteItems. This indicates a data mismatch. Stopping at a random item.")),l=Math.floor(G.length/2)+Math.floor(10*Math.random()-5),l=Math.max(0,Math.min(l,G.length-1));l=G.length>10?Math.max(5,Math.min(l,G.length-5-1)):G.length>0?Math.max(0,Math.min(l,G.length-1)):0;let n=r.offsetWidth/2-54,i=108*l-n,o=7e3+2e3*Math.random(),d=r.scrollLeft,c=5+Math.floor(3*Math.random()),u=G.length/14*108,m=u*c+(i-d);i<d&&Math.abs(i-d)<u&&(m+=u);let f=performance.now(),h=e=>1-Math.pow(1-e,4),p=e=>{let t=(e-f)/o;t=Math.min(t,1);let a=h(t);r.scrollLeft=d+m*a,t<1?requestAnimationFrame(p):(r.scrollTo({left:i,behavior:"smooth"}),setTimeout(()=>{F(!0),R(!1)},400))};requestAnimationFrame(p)}catch(e){console.error("Spin error:",e),N({title:"Ошибка",description:"Произошла ошибка при открытии кейса.",variant:"destructive"}),R(!1)}}},er=()=>{if(D(null),F(!1),Z(null),J.current&&G.length>0){let e=Math.floor(G.length/3),t=Math.floor(Math.random()*e),a=Math.max(0,(e+t)*108-J.current.offsetWidth/2+54);J.current.scrollTo({left:a,behavior:"auto"})}},es=async()=>{if(S&&$&&P){X(!0);try{let e=await fetch("/api/prize/claim",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:S.id,caseOpeningId:$,prize:P})}),t=await e.json();if(!e.ok)throw Error(t.message||"Failed to claim prize");(null==S?void 0:S.id)&&await A(S.id),N({title:"balance_gh"===P.prize_type?"Баланс пополнен!":"Приз добавлен в инвентарь!",description:t.message,variant:"default",action:"balance_gh"!==P.prize_type?(0,r.jsx)(i.$,{variant:"link",size:"sm",asChild:!0,className:"text-primary",children:(0,r.jsx)(_(),{href:"/account/inventory",children:"В инвентарь"})}):(0,r.jsx)(c.A,{className:"text-primary"})})}catch(e){N({title:"Ошибка",description:e.message,variant:"destructive"})}finally{X(!1),er()}}},el=async()=>{if(S&&$&&P&&"number"==typeof P.sell_value_gh){X(!0);try{let e=await fetch("/api/prize/sell",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:S.id,caseOpeningId:$,prize:P})}),t=await e.json();if(!e.ok)throw Error(t.message||"Failed to sell prize");t.updatedUser&&S&&A&&A(S.id),N({title:"Приз продан!",description:t.message,variant:"default",action:(0,r.jsx)(u.A,{className:"text-primary"})})}catch(e){N({title:"Ошибка",description:e.message,variant:"destructive"})}finally{X(!1),er()}}};return z?(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8 flex flex-col items-center justify-center min-h-[calc(100vh-var(--header-height)-var(--footer-height))]",children:[(0,r.jsx)(m.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,r.jsx)("p",{className:"mt-4 text-lg text-muted-foreground",children:"Загрузка кейса..."})]}):T||!M?(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8 text-center",children:[(0,r.jsx)(f.A,{className:"mx-auto h-12 w-12 text-destructive mb-4"}),(0,r.jsx)("p",{className:"text-lg text-destructive-foreground",children:T||"Кейс не найден."}),(0,r.jsx)(i.$,{asChild:!0,variant:"outline",className:"mt-6 border-primary text-primary hover:bg-primary/10",children:(0,r.jsxs)(_(),{href:"/",children:[(0,r.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"На главную"]})})]}):(0,r.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background text-foreground p-2 md:p-4 overflow-hidden",children:(0,r.jsxs)(o.Zp,{className:"w-full max-w-4xl bg-card border-border shadow-2xl rounded-xl overflow-hidden my-4",children:[(0,r.jsxs)(o.aR,{className:"p-4 border-b border-border/50 flex flex-row items-center justify-between bg-card/80 backdrop-blur-sm",children:[(0,r.jsxs)(i.$,{variant:"ghost",size:"icon",onClick:()=>t.back(),className:"text-muted-foreground hover:text-primary",children:[(0,r.jsx)(h.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"sr-only",children:"Назад"})]}),(0,r.jsx)(o.ZB,{className:"text-xl md:text-2xl font-semibold text-primary text-center uppercase tracking-wider",children:M.name}),(0,r.jsx)("div",{className:"w-9 h-9",children:" "})]}),(0,r.jsxs)(o.Wu,{className:"p-3 md:p-6 space-y-3 md:space-y-4 flex flex-col items-center",children:[(0,r.jsx)("div",{className:"relative w-40 h-40 md:w-48 md:h-48 mb-2",children:(0,r.jsx)(n.default,{src:M.imageUrl||"https://placehold.co/300x300.png?text=Case",alt:M.name,layout:"fill",objectFit:"contain",className:"rounded-md","data-ai-hint":M.data_ai_hint||"case image",priority:!0})}),M.timer_enabled&&M.timer_ends_at&&(0,r.jsx)(k,{endsAt:M.timer_ends_at,onTimerEnd:()=>Y(!0)}),G.length>0&&(0,r.jsxs)("div",{className:"relative w-full max-w-full roulette-container p-2 rounded-lg overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-1 h-[calc(100%-1rem)] bg-primary rounded-full pointer-events-none z-10 roulette-marker shadow-[0_0_8px_2px_hsl(var(--primary)/0.7)]"}),(0,r.jsx)("div",{ref:J,className:"flex h-full overflow-x-auto no-scrollbar items-center",children:G.map(e=>(0,r.jsxs)("div",{className:"roulette-item flex-shrink-0 flex flex-col items-center justify-between p-1.5 mx-1.5 transition-all duration-300 transform-gpu rounded-lg bg-card/70 backdrop-blur-sm",style:{width:"".concat(100,"px"),height:"".concat(120,"px")},children:[(0,r.jsx)("div",{className:"relative overflow-hidden prize-image-container rounded-full w-20 h-20 md:w-24 md:h-24 border-none",children:(0,r.jsx)(n.default,{src:e.imageUrl||"https://placehold.co/120x120.png",alt:e.name,layout:"fill",objectFit:"cover",className:"rounded-full border-none","data-ai-hint":e.data_ai_hint||"prize item icon"})}),(0,r.jsxs)("div",{className:"text-center w-full mt-auto",children:[(0,r.jsx)("p",{className:"text-[10px] md:text-xs text-center font-medium text-foreground truncate w-full px-1",title:e.name,children:e.name}),(0,r.jsx)("p",{className:"text-[9px] md:text-[10px] text-center text-primary/80 font-semibold",children:"product_duration"===e.prize_type&&e.duration_days?"".concat(e.duration_days," дн."):"balance_gh"===e.prize_type&&e.balance_gh_amount?"".concat(e.balance_gh_amount," GH"):""})]})]},e.uniqueKey))})]}),(0,r.jsx)(d.lG,{open:L,onOpenChange:e=>{e||er()},children:(0,r.jsxs)(d.Cf,{className:"sm:max-w-md bg-card border-border/30 shadow-xl",children:[(0,r.jsxs)(d.c7,{className:"text-center",children:[(0,r.jsx)(d.L3,{className:"text-2xl font-bold text-primary mb-2",children:"Поздравляем!"}),(0,r.jsx)(d.rr,{className:"text-muted-foreground",children:"Вы выиграли:"})]}),P&&(0,r.jsxs)("div",{className:"flex flex-col items-center py-4 space-y-3",children:[(0,r.jsx)("div",{className:"relative overflow-hidden dialog-prize-image-container rounded-full w-32 h-32 md:w-40 md:h-40 border-none",children:(0,r.jsx)(n.default,{src:P.imageUrl||"https://placehold.co/150x150.png",alt:P.name,layout:"fill",objectFit:"cover",className:"rounded-full shadow-md border-none","data-ai-hint":P.data_ai_hint||"prize item large image"})}),(0,r.jsx)("p",{className:"text-xl font-bold text-foreground bg-primary/10 px-4 py-1 rounded-md shadow-inner",children:P.name}),(0,r.jsx)("p",{className:"text-sm text-primary/90 font-semibold",children:"product_duration"===P.prize_type&&P.duration_days?"".concat(P.duration_days," дн."):"balance_gh"===P.prize_type&&P.balance_gh_amount?"".concat(P.balance_gh_amount," GH"):""})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 justify-center pt-2",children:[(0,r.jsxs)(i.$,{onClick:es,size:"sm",className:"bg-primary hover:bg-primary/90 text-primary-foreground flex-1 shadow-md",disabled:V,children:[V&&(null==P?void 0:P.prize_type)!=="balance_gh"?(0,r.jsx)(m.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,r.jsx)(p.A,{className:"mr-2 h-4 w-4"}),(null==P?void 0:P.prize_type)==="balance_gh"?"ОК (Баланс зачислен)":"Забрать"]}),(null==P?void 0:P.prize_type)!=="balance_gh"&&(null==P?void 0:P.sell_value_gh)&&P.sell_value_gh>0&&(0,r.jsxs)(i.$,{onClick:el,variant:"outline",size:"sm",className:"border-primary text-primary hover:bg-primary/10 hover:text-primary/90 flex-1 shadow-sm",disabled:V,children:[V?(0,r.jsx)(m.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,r.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Продать за ",P.sell_value_gh," GH"]})]}),(0,r.jsxs)(i.$,{onClick:er,variant:"ghost",size:"sm",className:"mt-3 text-primary hover:bg-primary/10 w-full",disabled:V,children:[(0,r.jsx)(x,{className:"mr-2 h-4 w-4"})," Открыть еще"]})]})}),!L&&(0,r.jsxs)("div",{className:"w-full max-w-md mx-auto space-y-3 md:space-y-4 px-2 mt-3 md:mt-4",children:[Q.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h4",{className:"text-xs md:text-sm font-medium text-foreground/70 text-center uppercase tracking-wider mb-1",children:"Улучшить Шанс:"}),(0,r.jsx)("div",{className:"flex flex-row flex-wrap justify-center items-center gap-x-3 gap-y-1.5",children:Q.map(e=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(w.S,{id:"boost-".concat(e.id),checked:U.some(t=>t.id===e.id),onCheckedChange:t=>et(e,!!t),className:"mr-1.5 h-4 w-4 border-primary/70 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",disabled:O||K||z}),(0,r.jsxs)(j.Label,{htmlFor:"boost-".concat(e.id),className:"text-xs md:text-sm cursor-pointer flex items-baseline gap-1 text-foreground/80",children:[(0,r.jsx)("span",{children:e.label}),(0,r.jsxs)("span",{className:"text-icon-color/80 text-[10px] md:text-xs",children:["(",e.cost>0?"+".concat(e.cost,"GH"):"Беспл.",")"]})]})]},e.id))})]}),(0,r.jsx)("div",{className:"flex flex-col sm:flex-row gap-2 justify-center pt-2 md:pt-3",children:(0,r.jsxs)(i.$,{onClick:ea,disabled:O||!G.length||!S||K||z||S&&S.balance<q,size:"lg",className:"w-full sm:w-auto sm:flex-1 max-w-[250px] bg-primary hover:bg-primary/90 text-primary-foreground shadow-md text-base h-11 md:h-12 py-2",children:[O?(0,r.jsx)(m.A,{className:"mr-2 h-5 w-5 animate-spin"}):(0,r.jsx)(g.A,{className:"mr-2 h-5 w-5"}),O?"Открывается...":"Открыть за ".concat(q.toFixed(0)," GH")]})})]}),M.prizes&&M.prizes.length>0&&(0,r.jsxs)("div",{className:"w-full mt-4 md:mt-6 pt-3 md:pt-4 border-t border-border/30",children:[(0,r.jsx)("h4",{className:"text-base font-semibold text-muted-foreground text-center mb-2 md:mb-3",children:"Возможные призы в этом кейсе:"}),(0,r.jsx)("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 md:gap-3 max-h-56 overflow-y-auto p-1.5 rounded-md bg-muted/30 shadow-inner",children:M.prizes.map(e=>(0,r.jsxs)("div",{className:"flex flex-col items-center p-1.5 bg-card rounded-lg shadow-sm",children:[(0,r.jsx)("div",{className:"relative overflow-hidden prize-image-container rounded-full w-16 h-16 md:w-20 md:h-20 border-none",children:(0,r.jsx)(n.default,{src:e.imageUrl||"https://placehold.co/100x100.png",alt:e.name,layout:"fill",objectFit:"cover",className:"rounded-full border-none","data-ai-hint":e.data_ai_hint||"small prize icon"})}),(0,r.jsx)("p",{className:"text-xs text-center font-medium text-foreground/90 mt-1.5 truncate w-full",title:e.name,children:e.name}),(0,r.jsx)("p",{className:"text-[10px] text-center text-primary/80",children:e.duration_days?"".concat(e.duration_days," дн."):e.balance_gh_amount?"".concat(e.balance_gh_amount," GH"):""})]},e.id))})]})]})]})})}},54165:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>m,Es:()=>h,L3:()=>p,c7:()=>f,lG:()=>o,rr:()=>x,zM:()=>d});var r=a(95155),s=a(12115),l=a(15452),n=a(25318),i=a(59434);let o=l.bL,d=l.l9,c=l.ZL;l.bm;let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});u.displayName=l.hJ.displayName;let m=s.forwardRef((e,t)=>{let{className:a,children:s,...o}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(u,{}),(0,r.jsxs)(l.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[s,(0,r.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(n.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=l.UC.displayName;let f=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};f.displayName="DialogHeader";let h=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};h.displayName="DialogFooter";let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...s})});p.displayName=l.hE.displayName;let x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...s})});x.displayName=l.VY.displayName},59434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var r=a(52596),s=a(39688);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}},66695:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>n,aR:()=>i,wL:()=>u});var r=a(95155),s=a(12115),l=a(59434);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});n.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",a),...s})});i.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,l.cn)("text-xl font-normal uppercase tracking-wider leading-none",a),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",a),...s})});u.displayName="CardFooter"},66766:(e,t,a)=>{"use strict";a.d(t,{default:()=>s.a});var r=a(71469),s=a.n(r)},71469:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return o},getImageProps:function(){return i}});let r=a(88229),s=a(38883),l=a(33063),n=r._(a(51193));function i(e){let{props:t}=(0,s.getImgProps)(e,{defaultLoader:n.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}}let o=l.Image},76981:(e,t,a)=>{"use strict";a.d(t,{C1:()=>k,bL:()=>_});var r=a(12115),s=a(6101),l=a(46081),n=a(85185),i=a(5845),o=a(45503),d=a(11275),c=a(28905),u=a(63655),m=a(95155),f="Checkbox",[h,p]=(0,l.A)(f),[x,g]=h(f),y=r.forwardRef((e,t)=>{let{__scopeCheckbox:a,name:l,checked:o,defaultChecked:d,required:c,disabled:f,value:h="on",onCheckedChange:p,form:g,...y}=e,[b,v]=r.useState(null),_=(0,s.s)(t,e=>v(e)),k=r.useRef(!1),S=!b||g||!!b.closest("form"),[A=!1,M]=(0,i.i)({prop:o,defaultProp:d,onChange:p}),C=r.useRef(A);return r.useEffect(()=>{let e=null==b?void 0:b.form;if(e){let t=()=>M(C.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[b,M]),(0,m.jsxs)(x,{scope:a,state:A,disabled:f,children:[(0,m.jsx)(u.sG.button,{type:"button",role:"checkbox","aria-checked":j(A)?"mixed":A,"aria-required":c,"data-state":N(A),"data-disabled":f?"":void 0,disabled:f,value:h,...y,ref:_,onKeyDown:(0,n.m)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,n.m)(e.onClick,e=>{M(e=>!!j(e)||!e),S&&(k.current=e.isPropagationStopped(),k.current||e.stopPropagation())})}),S&&(0,m.jsx)(w,{control:b,bubbles:!k.current,name:l,value:h,checked:A,required:c,disabled:f,form:g,style:{transform:"translateX(-100%)"},defaultChecked:!j(d)&&d})]})});y.displayName=f;var b="CheckboxIndicator",v=r.forwardRef((e,t)=>{let{__scopeCheckbox:a,forceMount:r,...s}=e,l=g(b,a);return(0,m.jsx)(c.C,{present:r||j(l.state)||!0===l.state,children:(0,m.jsx)(u.sG.span,{"data-state":N(l.state),"data-disabled":l.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});v.displayName=b;var w=e=>{let{control:t,checked:a,bubbles:s=!0,defaultChecked:l,...n}=e,i=r.useRef(null),c=(0,o.Z)(a),u=(0,d.X)(t);r.useEffect(()=>{let e=i.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(c!==a&&t){let r=new Event("click",{bubbles:s});e.indeterminate=j(a),t.call(e,!j(a)&&a),e.dispatchEvent(r)}},[c,a,s]);let f=r.useRef(!j(a)&&a);return(0,m.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:null!=l?l:f.current,...n,tabIndex:-1,ref:i,style:{...e.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function j(e){return"indeterminate"===e}function N(e){return j(e)?"indeterminate":e?"checked":"unchecked"}var _=y,k=v},85057:(e,t,a)=>{"use strict";a.d(t,{Label:()=>d});var r=a(95155),s=a(12115),l=a(40968),n=a(74466),i=a(59434);let o=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.b,{ref:t,className:(0,i.cn)(o(),a),...s})});d.displayName=l.b.displayName},87481:(e,t,a)=>{"use strict";a.d(t,{dj:()=>m});var r=a(12115);let s=0,l=new Map,n=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?n(a):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=i(d,e),o.forEach(e=>{e(d)})}function u(e){let{...t}=e,a=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=r.useState(d);return r.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},88390:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},94815:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},96016:(e,t,a)=>{"use strict";a.d(t,{Y:()=>s,z:()=>r});let r=[{id:"no-boost",label:"Стандарт",cost:0,chanceMultiplier:1,description:"Базовый шанс."},{id:"boost10",label:"+10%",cost:10,chanceMultiplier:1.1,description:"Шанс x1.10"},{id:"boost50",label:"+50%",cost:100,chanceMultiplier:1.5,description:"Шанс x1.50"},{id:"boost70",label:"+70%",cost:1e3,chanceMultiplier:1.7,description:"Шанс x1.70"}],s="warface-allin"}},e=>{var t=t=>e(e.s=t);e.O(0,[4277,7576,5756,6874,3063,5452,8441,1684,7358],()=>t(12867)),_N_E=e.O()}]);