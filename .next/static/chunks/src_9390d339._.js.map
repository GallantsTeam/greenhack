{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport {cn} from '@/lib/utils';\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, React.ComponentProps<'textarea'>>(\n  ({className, ...props}, ref) => {\n    return (\n      <textarea\n        className={cn(\n          'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\nTextarea.displayName = 'Textarea';\n\nexport {Textarea};\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAEA,MAAM,yBAAW,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAC9B,CAAC,EAAC,SAAS,EAAE,GAAG,OAAM,EAAE;IACtB,qBACE,6LAAC;QACC,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,qTACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,SAAS,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/admin/editor/offer-editor/page.tsx"],"sourcesContent":["\n'use client';\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport * as z from 'zod';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Button } from '@/components/ui/button';\nimport { Loader2, ShieldCheck } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport type { SiteSettings } from '@/types';\n\nconst offerSchema = z.object({\n  offer_page_content: z.string().optional().nullable(),\n});\n\ntype OfferFormValues = z.infer<typeof offerSchema>;\n\nexport default function AdminOfferEditorPage() {\n  const { toast } = useToast();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isFetching, setIsFetching] = useState(true);\n\n  const form = useForm<OfferFormValues>({\n    resolver: zodResolver(offerSchema),\n    defaultValues: {\n      offer_page_content: '',\n    },\n  });\n\n  const fetchOfferContent = useCallback(async () => {\n    setIsFetching(true);\n    try {\n      const response = await fetch('/api/admin/site-settings');\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({ message: 'Не удалось загрузить контент оферты.' }));\n        throw new Error(errorData.message);\n      }\n      const data: SiteSettings = await response.json();\n      form.reset({\n        offer_page_content: data.offer_page_content || '',\n      });\n    } catch (error: any) {\n      toast({ title: \"Ошибка загрузки\", description: error.message, variant: \"destructive\" });\n    } finally {\n      setIsFetching(false);\n    }\n  }, [form, toast]);\n\n  useEffect(() => {\n    fetchOfferContent();\n  }, [fetchOfferContent]);\n\n  const onSubmit = async (data: OfferFormValues) => {\n    setIsLoading(true);\n    try {\n      const existingSettingsRes = await fetch('/api/admin/site-settings');\n      if (!existingSettingsRes.ok) throw new Error('Could not fetch existing settings to merge.');\n      const existingSettings: SiteSettings = await existingSettingsRes.json();\n      \n      const payload = { ...existingSettings, offer_page_content: data.offer_page_content };\n\n      const response = await fetch('/api/admin/site-settings', {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload),\n      });\n      const result = await response.json();\n      if (!response.ok) throw new Error(result.message || 'Не удалось сохранить оферту.');\n      toast({ title: \"Оферта обновлена\", description: \"Содержимое страницы публичной оферты успешно обновлено.\" });\n      if(result.settings) {\n        form.reset({ offer_page_content: result.settings.offer_page_content || '' });\n      }\n    } catch (error: any) {\n      toast({ title: \"Ошибка сохранения\", description: error.message, variant: \"destructive\" });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (isFetching) {\n    return (\n      <div className=\"flex items-center justify-center p-10\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n        <p className=\"ml-3 text-muted-foreground\">Загрузка редактора оферты...</p>\n      </div>\n    );\n  }\n\n  return (\n    <Card className=\"shadow-lg\">\n      <CardHeader>\n        <CardTitle className=\"text-xl font-bold text-primary flex items-center\">\n          <ShieldCheck className=\"mr-2 h-5 w-5\" />\n          Редактор страницы Публичной Оферты\n        </CardTitle>\n        <CardDescription className=\"text-muted-foreground\">\n          Введите или отредактируйте HTML-содержимое для страницы публичной оферты вашего сайта.\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n          <div>\n            <Label htmlFor=\"offer_page_content\" className=\"text-foreground\">HTML-контент оферты</Label>\n            <Textarea\n              id=\"offer_page_content\"\n              {...form.register(\"offer_page_content\")}\n              placeholder=\"<p>Ваша публичная оферта здесь...</p> <h4>Раздел 1</h4> <p>...</p>\"\n              className=\"mt-1 min-h-[400px] font-mono text-sm bg-muted/30 border-border\"\n              disabled={isLoading}\n            />\n            {form.formState.errors.offer_page_content && (\n              <p className=\"text-sm text-destructive mt-1\">{form.formState.errors.offer_page_content.message}</p>\n            )}\n          </div>\n          <div className=\"flex justify-end pt-4\">\n            <Button type=\"submit\" className=\"bg-primary hover:bg-primary/90 text-primary-foreground\" disabled={isLoading || isFetching}>\n              {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n              Сохранить оферту\n            </Button>\n          </div>\n        </form>\n      </CardContent>\n    </Card>\n  );\n}\n"],"names":[],"mappings":";;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;;;AAXA;;;;;;;;;;;AAcA,MAAM,cAAc,CAAA,GAAA,uIAAA,CAAA,SAAQ,AAAD,EAAE;IAC3B,oBAAoB,CAAA,GAAA,uIAAA,CAAA,SAAQ,AAAD,IAAI,QAAQ,GAAG,QAAQ;AACpD;AAIe,SAAS;;IACtB,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,+HAAA,CAAA,WAAQ,AAAD;IACzB,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAE7C,MAAM,OAAO,CAAA,GAAA,iKAAA,CAAA,UAAO,AAAD,EAAmB;QACpC,UAAU,CAAA,GAAA,iKAAA,CAAA,cAAW,AAAD,EAAE;QACtB,eAAe;YACb,oBAAoB;QACtB;IACF;IAEA,MAAM,oBAAoB,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;+DAAE;YACpC,cAAc;YACd,IAAI;gBACF,MAAM,WAAW,MAAM,MAAM;gBAC7B,IAAI,CAAC,SAAS,EAAE,EAAE;oBAChB,MAAM,YAAY,MAAM,SAAS,IAAI,GAAG,KAAK;+EAAC,IAAM,CAAC;gCAAE,SAAS;4BAAuC,CAAC;;oBACxG,MAAM,IAAI,MAAM,UAAU,OAAO;gBACnC;gBACA,MAAM,OAAqB,MAAM,SAAS,IAAI;gBAC9C,KAAK,KAAK,CAAC;oBACT,oBAAoB,KAAK,kBAAkB,IAAI;gBACjD;YACF,EAAE,OAAO,OAAY;gBACnB,MAAM;oBAAE,OAAO;oBAAmB,aAAa,MAAM,OAAO;oBAAE,SAAS;gBAAc;YACvF,SAAU;gBACR,cAAc;YAChB;QACF;8DAAG;QAAC;QAAM;KAAM;IAEhB,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;0CAAE;YACR;QACF;yCAAG;QAAC;KAAkB;IAEtB,MAAM,WAAW,OAAO;QACtB,aAAa;QACb,IAAI;YACF,MAAM,sBAAsB,MAAM,MAAM;YACxC,IAAI,CAAC,oBAAoB,EAAE,EAAE,MAAM,IAAI,MAAM;YAC7C,MAAM,mBAAiC,MAAM,oBAAoB,IAAI;YAErE,MAAM,UAAU;gBAAE,GAAG,gBAAgB;gBAAE,oBAAoB,KAAK,kBAAkB;YAAC;YAEnF,MAAM,WAAW,MAAM,MAAM,4BAA4B;gBACvD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;YACvB;YACA,MAAM,SAAS,MAAM,SAAS,IAAI;YAClC,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM,OAAO,OAAO,IAAI;YACpD,MAAM;gBAAE,OAAO;gBAAoB,aAAa;YAA0D;YAC1G,IAAG,OAAO,QAAQ,EAAE;gBAClB,KAAK,KAAK,CAAC;oBAAE,oBAAoB,OAAO,QAAQ,CAAC,kBAAkB,IAAI;gBAAG;YAC5E;QACF,EAAE,OAAO,OAAY;YACnB,MAAM;gBAAE,OAAO;gBAAqB,aAAa,MAAM,OAAO;gBAAE,SAAS;YAAc;QACzF,SAAU;YACR,aAAa;QACf;IACF;IAEA,IAAI,YAAY;QACd,qBACE,6LAAC;YAAI,WAAU;;8BACb,6LAAC,oNAAA,CAAA,UAAO;oBAAC,WAAU;;;;;;8BACnB,6LAAC;oBAAE,WAAU;8BAA6B;;;;;;;;;;;;IAGhD;IAEA,qBACE,6LAAC,mIAAA,CAAA,OAAI;QAAC,WAAU;;0BACd,6LAAC,mIAAA,CAAA,aAAU;;kCACT,6LAAC,mIAAA,CAAA,YAAS;wBAAC,WAAU;;0CACnB,6LAAC,uNAAA,CAAA,cAAW;gCAAC,WAAU;;;;;;4BAAiB;;;;;;;kCAG1C,6LAAC,mIAAA,CAAA,kBAAe;wBAAC,WAAU;kCAAwB;;;;;;;;;;;;0BAIrD,6LAAC,mIAAA,CAAA,cAAW;0BACV,cAAA,6LAAC;oBAAK,UAAU,KAAK,YAAY,CAAC;oBAAW,WAAU;;sCACrD,6LAAC;;8CACC,6LAAC,oIAAA,CAAA,QAAK;oCAAC,SAAQ;oCAAqB,WAAU;8CAAkB;;;;;;8CAChE,6LAAC,uIAAA,CAAA,WAAQ;oCACP,IAAG;oCACF,GAAG,KAAK,QAAQ,CAAC,qBAAqB;oCACvC,aAAY;oCACZ,WAAU;oCACV,UAAU;;;;;;gCAEX,KAAK,SAAS,CAAC,MAAM,CAAC,kBAAkB,kBACvC,6LAAC;oCAAE,WAAU;8CAAiC,KAAK,SAAS,CAAC,MAAM,CAAC,kBAAkB,CAAC,OAAO;;;;;;;;;;;;sCAGlG,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC,qIAAA,CAAA,SAAM;gCAAC,MAAK;gCAAS,WAAU;gCAAyD,UAAU,aAAa;;oCAC7G,2BAAa,6LAAC,oNAAA,CAAA,UAAO;wCAAC,WAAU;;;;;;oCAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ9E;GA3GwB;;QACJ,+HAAA,CAAA,WAAQ;QAIb,iKAAA,CAAA,UAAO;;;KALE","debugId":null}}]
}